# ============================================================================
# SCEC TPV101: Rate-and-State Friction - Aging Law, Homogeneous
# ============================================================================
# Basic test of rate-and-state friction implementation
# Reference: http://scec.org/cvws/download/TPV101_Description_v05.pdf
# ============================================================================

[SIMULATION]
name = SCEC_TPV101
description = "Rate-and-state friction with aging law, homogeneous parameters"

start_time = 0.0
end_time = 15.0
dt_initial = 0.0001                # Small timestep for rate-state
dt_min = 1e-8
dt_max = 0.001

output_frequency = 100
output_format = HDF5
output_directory = output/tpv101

# Numerical method
use_discontinuous_galerkin = true
dg_order = 4
use_ader_time_integration = true
enable_local_time_stepping = true
lts_rate = 2

enable_elastodynamics = true
enable_dynamic_rupture = true

use_gpu = true

[GRID]
nx = 300
ny = 1
nz = 150
Lx = 48000.0                       # 48 km
Ly = 100.0
Lz = 20000.0                       # 20 km

[ROCK]
youngs_modulus = 32.04e9
poisson_ratio = 0.25
density = 2670.0
p_wave_velocity = 6000.0
s_wave_velocity = 3464.0

enable_attenuation = false

[FAULT1]
type = PLANAR_VERTICAL
strike = 0.0
dip = 90.0
x_center = 0.0
y_center = 0.0
z_center = -8660.0
length = 48000.0
width = 17320.0

# Rate-and-state friction - AGING LAW
friction_law = RATE_STATE_AGING
rs_a = 0.010                       # Direct effect parameter
rs_b = 0.014                       # Evolution effect parameter (VW)
rs_L = 0.02                        # State evolution distance [m]
rs_f0 = 0.6                        # Reference friction
rs_V0 = 1.0e-6                     # Reference velocity [m/s]

# Initial state
rs_initial_slip_rate_strike = 0.0
rs_initial_slip_rate_dip = 0.0
rs_initial_state_variable = 2.0e7  # θ_0 = L / V_0 = 0.02 / 1e-6 = 2e7 s

# Initial stress (homogeneous)
initial_stress_xx = 0.0
initial_stress_yy = -120.0e6       # Normal stress
initial_stress_zz = 0.0
initial_stress_xy = 75.0e6         # Shear stress (right-lateral)
initial_stress_xz = 0.0
initial_stress_yz = 0.0

# Nucleation patch
nucleation_type = SPATIAL_PATCH
nucleation_x_center = 0.0
nucleation_z_center = -10000.0
nucleation_radius = 3000.0
nucleation_overstress = 1.32       # 32% overstress (to 99 MPa)

use_split_nodes = true
split_node_method = PENALTY

[RATE_STATE_PARAMETERS]
# TPV101 uses aging law:
# dθ/dt = 1 - (V θ) / L
#
# Friction:
# f = a × asinh[(V / (2 V_0)) × exp((f_0 + b ln(V_0 θ / L)) / a)]
#
# Stability: a - b < 0 → velocity weakening (unstable)
# For TPV101: a - b = 0.010 - 0.014 = -0.004 < 0 → VW

# Critical stiffness (for spring-slider analogy):
# k_c = (b - a) σ_n / L
# For TPV101: k_c = (0.014 - 0.010) × 120e6 / 0.02 = 24 GPa/m

[BC1]
type = FREE_SURFACE
location = ZMAX

[BC2]
type = ABSORBING
location = XMIN,XMAX,YMIN,YMAX,ZMIN
absorbing_method = PML

[OUTPUT]
output_fault_data = true
fault_output_fields = slip,slip_rate,shear_stress,normal_stress,rupture_time,friction_coefficient,state_variable
fault_output_frequency = 10

volume_output_fields = velocity,displacement
volume_output_frequency = 100

enable_receivers = true
receiver_file = benchmarks/receivers_tpv101.txt

[VERIFICATION]
enable_verification = true
reference_solution_dir = benchmarks/reference/tpv101
verification_tolerance = 0.05

verify_rupture_time = true
verify_slip_distribution = true
verify_slip_rate = true
verify_state_evolution = true

[ANALYSIS]
compute_rupture_velocity = true
analyze_rate_state_evolution = true
compute_effective_friction = true

# Rate-and-state specific
track_state_variable = true
compute_healing = true
analyze_velocity_dependence = true

[NOTES]
# TPV101 Key Features:
# - Rate-and-state friction (aging law)
# - Homogeneous parameters
# - Velocity-weakening (a < b)
# - Tests basic rate-state implementation
#
# Expected Results:
# - Bilateral rupture propagation
# - Slip rate dependent friction
# - State variable evolution
# - Logarithmic strengthening at low V
# - Velocity weakening at high V
# - Rupture velocity ~0.8 × V_s
#
# Aging Law:
# - dθ/dt = 1 - V θ / L
# - State evolves with time
# - "Memory" of past contact
#
# Comparison with Slip-Weakening:
# - More physical (lab-derived)
# - Velocity-dependent
# - Healing behavior
# - More complex (ODE system)
