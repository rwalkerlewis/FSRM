# =============================================================================
# SPE11 Benchmark Configuration
# CO2 Geological Storage - Case B (Default)
# =============================================================================
#
# Reference: Nordbotten, J.M. et al., SPE Journal (2024)
#            https://spe11-group.github.io/
#
# The 11th SPE Comparative Solution Project focuses on CO2 storage simulation:
# - CO2-brine two-phase flow with dissolution
# - Density-driven convective mixing
# - Multiple trapping mechanisms (structural, residual, dissolution)
# - Long-term (1000 year) storage security
#
# This is Case B: 2D vertical cross-section (8.4 km × 1.2 km)
# For Case A (small) or Case C (3D), use the respective config files
#
# =============================================================================

[SIMULATION]
name = spe11b_co2_storage
description = SPE11 Case B - 2D CO2 Storage Benchmark
dimension = 2
physics = TWO_PHASE_FLOW
fluid_model = CO2_BRINE

# Time control (1000 years total)
start_time = 0.0
end_time = 31536000000.0
dt_initial = 86400.0
dt_min = 3600.0
dt_max = 31536000.0
time_unit = seconds
adaptive_timestepping = true

# Injection period: 50 years
injection_end_time = 1576800000.0

# Output
output_dir = output/spe11b
output_format = HDF5
output_frequency = 100

# Reporting times (years): 5, 10, 25, 50, 100, 200, 500, 1000
report_times = 157680000, 315360000, 788400000, 1576800000, 3153600000, 6307200000, 15768000000, 31536000000

[GRID]
# 2D domain: 8400 m × 1200 m
nx = 840
ny = 1
nz = 120
Lx = 8400.0
Ly = 100.0
Lz = 1200.0

# Uniform grid spacing: 10 m × 10 m
dx = 10.0
dz = 10.0

[ROCK]
# Heterogeneous permeability from facies
permeability_type = FACIES_BASED

# Seven facies types defined
num_facies = 7

# Facies 1: Reservoir sand (high perm)
[FACIES1]
name = reservoir_sand
porosity = 0.25
permeability = 2.0e-13
compressibility = 4.5e-10

# Facies 2: Channel sand
[FACIES2]
name = channel_sand
porosity = 0.30
permeability = 5.0e-12
compressibility = 4.5e-10

# Facies 3: Shale barrier
[FACIES3]
name = shale
porosity = 0.10
permeability = 1.0e-19
compressibility = 4.5e-10

# Facies 4: Seal rock
[FACIES4]
name = seal
porosity = 0.05
permeability = 1.0e-21
compressibility = 4.5e-10

# Facies 5: Transition zone
[FACIES5]
name = transition
porosity = 0.20
permeability = 1.0e-14
compressibility = 4.5e-10

# Facies 6: Boundary (inactive)
[FACIES6]
name = boundary
porosity = 0.01
permeability = 0.0
inactive = true

# Facies 7: Wellbore region
[FACIES7]
name = wellbore
porosity = 0.30
permeability = 1.0e-11
compressibility = 4.5e-10

# Load facies map from file or use default layered structure
# facies_file = data/spe11b_facies.dat

[CO2_PROPERTIES]
# CO2 equation of state
eos_model = SPAN_WAGNER

# Reference conditions
reference_pressure = 1.0e5
reference_temperature = 293.15

# CO2 properties at reservoir conditions (~300 bar, 50°C)
density_surface = 1.87
viscosity_surface = 1.48e-5

# Dissolution model
enable_dissolution = true
dissolution_model = DUAN_SUN
henry_coefficient = 3.4e-7

# Diffusion coefficient in brine
diffusion_coefficient = 2.0e-9

[BRINE_PROPERTIES]
# Brine composition
salinity = 0.1
reference_density = 1045.0
reference_viscosity = 0.0005
compressibility = 4.5e-10
thermal_expansion = 2.0e-4

[RELATIVE_PERMEABILITY]
model = BROOKS_COREY

# CO2-brine system
swc = 0.32
sgr = 0.10
krw_max = 0.60
krg_max = 0.40
nw = 4.0
ng = 2.0

# Hysteresis for trapping
enable_hysteresis = true
hysteresis_model = CARLSON
land_parameter = 1.5

[CAPILLARY_PRESSURE]
model = VAN_GENUCHTEN
entry_pressure = 3000.0
lambda = 0.8
max_pc = 1.0e6

[IC1]
# Hydrostatic pressure gradient
field = PRESSURE
distribution = GRADIENT
# P = 1e5 + 10000*(1200-z)  (hydrostatic from surface)
reference_value = 13.0e6
reference_depth = 1000.0
gradient = 0, 0, -10000

[IC2]
# Initial brine saturation = 1 (no CO2)
field = SATURATION_WATER
distribution = UNIFORM
value = 1.0

[IC3]
# Temperature gradient
field = TEMPERATURE
distribution = GRADIENT
reference_value = 323.15
reference_depth = 1000.0
gradient = 0, 0, -0.03

# CO2 injection well
[WELL1]
name = CO2_INJECTOR
type = INJECTOR
well_type = VERTICAL

# Location at x = 2700 m (left third of domain)
x = 2700.0
z_top = 300.0
z_bottom = 350.0

control_mode = RATE
# 15 kg/s CO2 injection rate
target_value = 0.0150
injection_fluid = CO2
max_bhp = 30.0e6

# Injection schedule
injection_start = 0.0
injection_end = 1576800000.0

[BC1]
# Top boundary: no flow (seal)
type = NO_FLOW
location = ZMAX

[BC2]
# Bottom boundary: no flow
type = NO_FLOW
location = ZMIN

[BC3]
# Left boundary: no flow
type = NO_FLOW
location = XMIN

[BC4]
# Right boundary: constant pressure (open)
type = DIRICHLET
location = XMAX
field = PRESSURE
value = 10.0e6

# Monitoring points for reporting
[MONITOR1]
name = obs_point_1
location = 5500.0, 50.0, 700.0
output_fields = pressure, saturation_co2, dissolved_co2

[MONITOR2]
name = obs_point_2
location = 5500.0, 50.0, 1000.0
output_fields = pressure, saturation_co2, dissolved_co2

# Output quantities for SPE11 comparison
[OUTPUT_FIELDS]
pressure = true
saturation_co2 = true
saturation_brine = true
dissolved_co2 = true
mobile_co2 = true
immobile_co2 = true
co2_mass_total = true
co2_mass_dissolved = true
co2_mass_mobile = true
co2_mass_immobile = true

[SOLVER]
method = IMPLICIT
newton_max_iterations = 25
newton_tolerance = 1.0e-6
linear_solver = GMRES
preconditioner = ILU
max_timestep_cuts = 10
