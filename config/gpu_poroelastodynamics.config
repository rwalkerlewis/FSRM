# GPU-Accelerated Poroelastodynamics with Dynamic Permeability
# Simulates earthquake-induced permeability changes in reservoir
# GPU acceleration provides 20-40x speedup for coupled dynamics

[SIMULATION]
start_time = 0.0
end_time = 100.0              # 100 seconds
dt_initial = 0.001            # 1 ms
dt_min = 1e-6
dt_max = 0.01

# GPU Configuration
use_gpu = true
gpu_mode = GPU_ONLY           # Force GPU execution (fail if GPU unavailable)
gpu_device_id = 0
gpu_verbose = true
gpu_memory_fraction = 0.90

# GPU-specific optimizations
use_gpu_preconditioner = true
use_gpu_matrix_assembly = true
pin_host_memory = true

# Time stepping
enable_adaptive_timestepping = true
max_timesteps = 100000

# Output
output_frequency = 50
output_format = VTK
checkpointing = true
checkpoint_frequency = 500

# Solver
rtol = 1e-5
atol = 1e-7
max_nonlinear_iterations = 30
max_linear_iterations = 1000

# Physics - Coupled poroelastodynamics
fluid_model = SINGLE_COMPONENT
solid_model = POROELASTODYNAMIC
enable_poroelastodynamics = true
use_dynamic_mode = true

# Static-to-dynamic triggering
use_static_triggering = true
dynamic_trigger_threshold = 5.0e6     # 5 MPa
dynamic_event_duration = 20.0         # 20 seconds

# Dynamic permeability changes
enable_dynamic_permeability_change = true
permeability_sensitivity = 1.0
permeability_recovery_time = 300.0    # 5 minutes recovery

[GRID]
nx = 150
ny = 150
nz = 75
Lx = 750.0     # meters
Ly = 750.0
Lz = 375.0

[ROCK]
# Sandstone reservoir
porosity = 0.20
permeability_x = 100.0e-15    # 100 mD
permeability_y = 100.0e-15
permeability_z = 30.0e-15     # Anisotropic

# Mechanical properties
youngs_modulus = 15.0e9       # 15 GPa (softer sandstone)
poisson_ratio = 0.25
density = 2300.0              # kg/mÂ³

# Biot poroelastic parameters
biot_coefficient = 0.8
biot_modulus = 5.0e9

# Wave properties
p_wave_velocity = 3500.0      # Fast P-wave
s_wave_velocity = 2000.0      # S-wave
damping_alpha = 0.02
damping_beta = 0.0002

# Dynamic permeability parameters
permeability_strain_coeff = 1e-7      # Strain sensitivity
permeability_stress_coeff = 1e-15     # Stress sensitivity
min_permeability = 1e-18              # 0.001 mD
max_permeability = 1e-11              # 10,000 mD

[FLUID]
density = 1000.0              # Water
viscosity = 0.001             # 1 cP
compressibility = 4.5e-10     # 1/Pa
bulk_modulus = 2.2e9          # Water bulk modulus

[INITIAL_CONDITIONS]
# Initial pressure (hydrostatic)
pressure_type = GRADIENT
pressure_surface = 1.0e5      # 1 bar
pressure_gradient = 0, 0, 10000  # Hydrostatic (10 kPa/m)

# Initial stress (lithostatic)
stress_type = GRADIENT
stress_surface = 0
stress_gradient_x = 0, 0, 0
stress_gradient_y = 0, 0, 0
stress_gradient_z = 0, 0, 22000  # Overburden (22 kPa/m)

[FAULT]
# Seismic fault for dynamic triggering
name = FAULT1
type = PLANAR
strike = 0                    # North-South
dip = 90                      # Vertical
length = 500
width = 300
center = 375, 375, 187.5

# Friction properties
static_friction = 0.6
dynamic_friction = 0.4
cohesion = 1.0e6

# Rate-and-state friction (for rupture)
use_rate_state = true
a_parameter = 0.01
b_parameter = 0.015
Dc_parameter = 0.01           # Critical slip distance (m)

[SOURCE]
# Initial stress perturbation to trigger event
type = STRESS_PULSE
location = 375, 375, 187.5
amplitude = 2.0e6             # 2 MPa stress pulse
duration = 1.0                # 1 second
shape = GAUSSIAN

[OBSERVATION]
# Monitor permeability changes
monitor_permeability = true
monitor_locations = 200,375,187; 375,375,187; 550,375,187
monitor_frequency = 10

# Compute seismic moment
compute_moment = true
fault_name = FAULT1

[OUTPUT]
fields = displacement,velocity,pressure,stress,permeability,porosity
save_fault_slip = true
save_moment_rate = true
