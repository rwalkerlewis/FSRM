# =============================================================================
# SCEC LOH.2 Benchmark Configuration
# Layer Over Halfspace - Heterogeneous Wave Propagation
# =============================================================================
#
# Reference: SCEC LOH Benchmarks
#            https://strike.scec.org/scecpedia/LOH.2
#
# Domain: 30 km × 30 km × 20 km
# Layers: Low-velocity layer (0-1 km), halfspace (>1 km)
# Source: Double-couple point source at 2 km depth
# Tests: Surface wave generation, layer reflections, Love waves
#
# =============================================================================

[SIMULATION]
name = scec_loh2
description = SCEC LOH.2 - Layer Over Halfspace (Heterogeneous)
dimension = 3
physics = ELASTODYNAMICS
solid_model = ELASTIC

start_time = 0.0
end_time = 9.0
dt_initial = 0.001
dt_min = 1.0e-5
dt_max = 0.01
adaptive_timestepping = true
cfl_number = 0.5

output_dir = output/scec_loh2
output_format = HDF5
output_frequency = 100

[GRID]
nx = 150
ny = 150
nz = 100
Lx = 30000.0
Ly = 30000.0
Lz = 20000.0
dx = 200.0
dy = 200.0
dz = 200.0

# Layered material model
[ROCK]
material_type = LAYERED

# Layer 1: Low-velocity surface layer (0-1 km)
[LAYER1]
name = surface_layer
z_top = 0.0
z_bottom = -1000.0
density = 2600.0
p_wave_velocity = 4000.0
s_wave_velocity = 2000.0

# Layer 2: Halfspace (>1 km)
[LAYER2]
name = halfspace
z_top = -1000.0
z_bottom = -20000.0
density = 2700.0
p_wave_velocity = 6000.0
s_wave_velocity = 3464.0

# Double-couple source
[SOURCE1]
type = MOMENT_TENSOR
name = double_couple_source

# Source location (at 2 km depth)
x = 15000.0
y = 15000.0
z = -2000.0

# Moment tensor (strike-slip)
moment = 1.0e18
strike = 0.0
dip = 90.0
rake = 0.0

# Source time function
source_time_function = GAUSSIAN
dominant_frequency = 1.0
half_duration = 0.5

[BC1]
type = FREE_SURFACE
location = ZMAX

[BC2]
type = ABSORBING
location = XMIN
method = CLAYTON_ENGQUIST

[BC3]
type = ABSORBING
location = XMAX
method = CLAYTON_ENGQUIST

[BC4]
type = ABSORBING
location = YMIN
method = CLAYTON_ENGQUIST

[BC5]
type = ABSORBING
location = YMAX
method = CLAYTON_ENGQUIST

[BC6]
type = ABSORBING
location = ZMIN
method = CLAYTON_ENGQUIST

# Surface receivers (radial array)
[RECEIVER1]
name = rec_R03
location = 18000.0, 15000.0, 0.0
output_fields = velocity, displacement

[RECEIVER2]
name = rec_R06
location = 21000.0, 15000.0, 0.0
output_fields = velocity, displacement

[RECEIVER3]
name = rec_R09
location = 24000.0, 15000.0, 0.0
output_fields = velocity, displacement

[RECEIVER4]
name = rec_R12
location = 27000.0, 15000.0, 0.0
output_fields = velocity, displacement

[RECEIVER5]
name = rec_T03
location = 15000.0, 18000.0, 0.0
output_fields = velocity, displacement

[RECEIVER6]
name = rec_T06
location = 15000.0, 21000.0, 0.0
output_fields = velocity, displacement

[SOLVER]
method = EXPLICIT
time_integration = RUNGE_KUTTA_4
