# =============================================================================
# SCEC TPV4 Benchmark Configuration
# 3D Strike-Slip with Rate-State Friction
# =============================================================================
#
# Reference: SCEC Code Verification Project
#            https://strike.scec.org/cvws/tpv4docs.html
#
# Domain: 3D elastic half-space, 48 km × 48 km × 24 km
# Fault: 30 km × 15 km vertical strike-slip fault
# Friction: Rate-and-state (aging law)
# VW zone surrounded by VS zone
#
# =============================================================================

[SIMULATION]
name = scec_tpv4
description = SCEC TPV4 - 3D Strike-Slip with Rate-State Friction
dimension = 3
physics = ELASTODYNAMICS
solid_model = ELASTIC

# Time control
start_time = 0.0
end_time = 15.0
dt_initial = 0.0005
dt_min = 1.0e-7
dt_max = 0.005
adaptive_timestepping = true

# CFL condition
cfl_number = 0.4

# Output
output_dir = output/scec_tpv4
output_format = HDF5
output_frequency = 200
checkpoint_frequency = 2000

[GRID]
# 3D domain
nx = 240
ny = 240
nz = 120

# Domain size (meters)
Lx = 48000.0
Ly = 48000.0
Lz = 24000.0

# Grid spacing: 200 m
dx = 200.0
dy = 200.0
dz = 200.0

[ROCK]
# Material properties
density = 2670.0
p_wave_velocity = 6000.0
s_wave_velocity = 3464.0
youngs_modulus = 32.04e9
poissons_ratio = 0.25
shear_modulus = 32.04e9

[FAULT1]
name = main_fault
type = STRIKE_SLIP

# Geometry - vertical fault at y = 0
x = 24000.0
y = 24000.0
z = -7500.0
strike = 0.0
dip = 90.0
rake = 0.0
length = 30000.0
width = 15000.0

# Rate-state friction
friction_law = RATE_STATE_AGING
use_rate_state = true
rate_state_a = 0.008
rate_state_b = 0.012
rate_state_dc = 0.02
rate_state_v0 = 1.0e-6
rate_state_f0 = 0.6
rate_state_theta0 = 2.0e7

# Velocity-weakening zone (a-b < 0)
# Surrounded by velocity-strengthening (a-b > 0)
vw_zone_length = 24000.0
vw_zone_width = 12000.0

# Initial stress state
initial_normal_stress = 120.0e6
initial_shear_stress = 75.0e6

# Nucleation
nucleation_type = VELOCITY_PERTURBATION
nucleation_center_x = 24000.0
nucleation_center_z = -7500.0
nucleation_size = 3000.0
nucleation_velocity = 1.0

[BC1]
type = FREE_SURFACE
location = ZMAX

[BC2]
type = ABSORBING
location = XMIN
method = PML
pml_thickness = 2000.0

[BC3]
type = ABSORBING
location = XMAX
method = PML
pml_thickness = 2000.0

[BC4]
type = ABSORBING
location = YMIN
method = PML
pml_thickness = 2000.0

[BC5]
type = ABSORBING
location = YMAX
method = PML
pml_thickness = 2000.0

[BC6]
type = ABSORBING
location = ZMIN
method = PML
pml_thickness = 2000.0

# Surface receivers
[RECEIVER1]
name = surf_st000dp000
location = 24000.0, 24000.0, 0.0
output_fields = velocity, displacement

[RECEIVER2]
name = surf_st030dp000
location = 27000.0, 24000.0, 0.0
output_fields = velocity, displacement

[RECEIVER3]
name = surf_st000dp030
location = 24000.0, 27000.0, 0.0
output_fields = velocity, displacement

# Fault receivers
[RECEIVER4]
name = flt_st000dp075
location = 24000.0, 24000.0, -7500.0
output_fields = slip_rate, slip, traction, state_variable

[RECEIVER5]
name = flt_st030dp075
location = 27000.0, 24000.0, -7500.0
output_fields = slip_rate, slip, traction, state_variable

[SOLVER]
method = EXPLICIT
time_integration = ADER_DG
polynomial_order = 4
