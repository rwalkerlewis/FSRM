# =============================================================================
# SCEC TPV15: Branching Fault - Branch Dominant
# =============================================================================
# Reference: https://strike.scec.org/cvws/tpv14_15docs.html
#
# Y-shaped fault geometry with branch fault becoming dominant.
# Stress state favors rupture continuing onto branch.
# =============================================================================

[SIMULATION]
name = scec_tpv15
description = SCEC TPV15 - Branching Fault Branch Dominant
dimension = 3
physics = ELASTODYNAMICS
time_integration = EXPLICIT

start_time = 0.0
end_time = 12.0
dt = 0.002
output_frequency = 50
output_dir = output/scec_tpv15
output_format = HDF5

[GRID]
nx = 401
ny = 201
nz = 151
Lx = 40000.0
Ly = 20000.0
Lz = 15000.0
dx = 100.0
dy = 100.0
dz = 100.0

[MATERIAL]
type = ELASTIC_HOMOGENEOUS
density = 2670.0
vp = 6000.0
vs = 3464.0

# Main fault segment (left of branch point)
[FAULT1]
name = main_fault_left
type = STRIKE_SLIP
geometry = PLANAR
strike = 0.0
dip = 90.0
x_start = 0.0
x_end = 20000.0
width = 15000.0
y_position = 10000.0

friction_model = SLIP_WEAKENING
static_friction = 0.677
dynamic_friction = 0.525
Dc = 0.40

normal_stress = -120.0e6
shear_stress_along_strike = 70.0e6

nucleation_type = OVERSTRESSED_PATCH
nucleation_center = 10000.0, 10000.0, 7500.0
nucleation_radius = 1500.0
nucleation_shear_stress = 81.6e6

# Main fault segment (right of branch point)
[FAULT2]
name = main_fault_right
type = STRIKE_SLIP
geometry = PLANAR
strike = 0.0
dip = 90.0
x_start = 20000.0
x_end = 40000.0
width = 15000.0
y_position = 10000.0

friction_model = SLIP_WEAKENING
static_friction = 0.677
dynamic_friction = 0.525
Dc = 0.40

# Lower stress on main continuation (favors branch)
normal_stress = -120.0e6
shear_stress_along_strike = 55.0e6

# Branch fault (30 degrees from main fault)
[FAULT3]
name = branch_fault
type = STRIKE_SLIP
geometry = PLANAR
strike = 30.0
dip = 90.0
x_start = 20000.0
x_end = 37320.5
width = 15000.0
branch_point = 20000.0, 10000.0, 0.0

friction_model = SLIP_WEAKENING
static_friction = 0.677
dynamic_friction = 0.525
Dc = 0.40

# Higher stress on branch (favors branch fault)
normal_stress = -120.0e6
shear_stress_along_strike = 70.0e6

[BC1]
type = FREE_SURFACE
location = ZMIN

[BC2]
type = ABSORBING
location = XMIN

[BC3]
type = ABSORBING
location = XMAX

[BC4]
type = ABSORBING
location = YMIN

[BC5]
type = ABSORBING
location = YMAX

[BC6]
type = ABSORBING
location = ZMAX

# Receivers on main fault
[RECEIVER1]
type = FAULT
fault = main_fault_left
location = 5000.0, 10000.0, 7500.0
output_fields = slip, slip_rate, shear_stress

[RECEIVER2]
type = FAULT
fault = main_fault_left
location = 15000.0, 10000.0, 7500.0
output_fields = slip, slip_rate, shear_stress

[RECEIVER3]
type = FAULT
fault = main_fault_right
location = 25000.0, 10000.0, 7500.0
output_fields = slip, slip_rate, shear_stress

# Receivers on branch fault
[RECEIVER4]
type = FAULT
fault = branch_fault
location = 25000.0, 12887.0, 7500.0
output_fields = slip, slip_rate, shear_stress

[RECEIVER5]
type = FAULT
fault = branch_fault
location = 30000.0, 15773.5, 7500.0
output_fields = slip, slip_rate, shear_stress

[RECEIVER6]
type = FAULT
fault = branch_fault
location = 35000.0, 18660.3, 7500.0
output_fields = slip, slip_rate, shear_stress

[SOLVER]
method = EXPLICIT
cfl = 0.5
