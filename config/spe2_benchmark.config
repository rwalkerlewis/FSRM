# =============================================================================
# SPE2 Benchmark Configuration
# Three-Phase Coning Problem
# =============================================================================
#
# Reference: Aziz, K. et al., "Simulation of Three-Phase Coning", SPE (1985)
#
# Tests three-phase (water-oil-gas) coning behavior:
# - Radial grid around producing well
# - Gas coning from gas cap
# - Water coning from aquifer
# - Critical rate analysis
#
# Grid: 10 radial Ã— 18 vertical = 180 cells
# Duration: 1825 days (5 years)
#
# =============================================================================

[SIMULATION]
name = spe2_coning
description = SPE2 - Three-Phase Coning Problem
physics = THREE_PHASE_FLOW
fluid_model = BLACK_OIL

start_time = 0.0
end_time = 1825.0
dt_initial = 0.1
dt_max = 10.0
time_unit = days

output_dir = output/spe2
output_format = HDF5
output_frequency = 30

[GRID]
# Radial grid
grid_type = RADIAL
nr = 10
nz = 18

# Radial dimensions (logarithmic spacing)
r_well = 0.1524
r_outer = 609.6
logarithmic_spacing = true

# Vertical dimensions
Lz = 109.7

[ROCK]
porosity = 0.30
permeability_r = 100.0
permeability_z = 10.0
compressibility = 4.35e-10

[FLUID]
# Oil properties
oil_density = 850.0
oil_viscosity = 0.0008
oil_formation_volume_factor = 1.2
oil_compressibility = 1.5e-9

# Water properties
water_density = 1025.0
water_viscosity = 0.0003
water_formation_volume_factor = 1.01
water_compressibility = 4.5e-10

# Gas properties
gas_density = 100.0
gas_viscosity = 0.00002
gas_formation_volume_factor = 0.01
gas_compressibility = 1.0e-7

# Solution GOR
solution_gas_oil_ratio = 90.0
bubble_point_pressure = 14.0e6

[RELATIVE_PERMEABILITY]
model = STONE_II

# Oil-water system
swc = 0.15
sowc = 0.20
krw_max = 0.35
krow_max = 0.90
nw = 2.0
now = 2.0

# Oil-gas system
sgc = 0.05
sorg = 0.20
krg_max = 0.80
krog_max = 0.90
ng = 2.0
nog = 2.0

[CAPILLARY_PRESSURE]
model = BROOKS_COREY
pcow_threshold = 0.0
pcog_threshold = 0.0

# Initial conditions - layered system
[IC1]
field = PRESSURE
distribution = GRADIENT
value = 27.0e6
gradient = 0, 0, 10000

# Initial saturations by zone
[IC2]
field = SATURATION_GAS
distribution = ZONAL

[IC2_ZONE1]
# Gas cap: layers 1-4
k_layers = 1, 2, 3, 4
value = 0.80

[IC2_ZONE2]
# Oil zone: layers 5-14
k_layers = 5, 6, 7, 8, 9, 10, 11, 12, 13, 14
value = 0.0

[IC2_ZONE3]
# Water zone: layers 15-18
k_layers = 15, 16, 17, 18
value = 0.0

[IC3]
field = SATURATION_WATER
distribution = ZONAL

[IC3_ZONE1]
k_layers = 1, 2, 3, 4
value = 0.15

[IC3_ZONE2]
k_layers = 5, 6, 7, 8, 9, 10, 11, 12, 13, 14
value = 0.15

[IC3_ZONE3]
k_layers = 15, 16, 17, 18
value = 0.85

# Central producer completed in oil zone only
[WELL1]
name = PROD_CENTER
type = PRODUCER
well_type = RADIAL_CENTER
k = 9, 10, 11, 12, 13, 14
wellbore_radius = 0.1524
skin = 0.0
control_mode = RATE
target_value = 0.015
min_bhp = 10.0e6

[BC1]
type = NO_FLOW
location = OUTER_RADIUS

[BC2]
type = NO_FLOW
location = TOP

[BC3]
type = NO_FLOW
location = BOTTOM

[SOLVER]
method = IMPLICIT
newton_max_iterations = 20
newton_tolerance = 1.0e-5
