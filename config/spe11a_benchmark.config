# =============================================================================
# SPE11 Case A Benchmark Configuration
# CO2 Geological Storage - Small 2D Test Case
# =============================================================================
#
# Reference: Nordbotten, J.M. et al., SPE Journal (2024)
#            https://spe11-group.github.io/
#
# Case A: Small 2D vertical cross-section for rapid testing
# Domain: 2.8 km × 1.2 km
# Duration: 1000 years (can use shorter for testing)
#
# =============================================================================

[SIMULATION]
name = spe11a_co2_storage
description = SPE11 Case A - Small 2D CO2 Storage Test
dimension = 2
physics = TWO_PHASE_FLOW
fluid_model = CO2_BRINE

start_time = 0.0
end_time = 31536000000.0
dt_initial = 86400.0
dt_min = 3600.0
dt_max = 31536000.0
time_unit = seconds
adaptive_timestepping = true

injection_end_time = 1576800000.0

output_dir = output/spe11a
output_format = HDF5
output_frequency = 50

[GRID]
# 2D domain: 2800 m × 1200 m (1/3 of Case B)
nx = 280
ny = 1
nz = 120
Lx = 2800.0
Ly = 100.0
Lz = 1200.0
dx = 10.0
dz = 10.0

[ROCK]
permeability_type = FACIES_BASED
num_facies = 7

[FACIES1]
name = reservoir_sand
porosity = 0.25
permeability = 2.0e-13

[FACIES2]
name = channel_sand
porosity = 0.30
permeability = 5.0e-12

[FACIES3]
name = shale
porosity = 0.10
permeability = 1.0e-19

[FACIES4]
name = seal
porosity = 0.05
permeability = 1.0e-21

[FACIES5]
name = transition
porosity = 0.20
permeability = 1.0e-14

[FACIES6]
name = boundary
porosity = 0.01
permeability = 0.0
inactive = true

[FACIES7]
name = wellbore
porosity = 0.30
permeability = 1.0e-11

[CO2_PROPERTIES]
eos_model = SPAN_WAGNER
enable_dissolution = true
dissolution_model = DUAN_SUN
diffusion_coefficient = 2.0e-9

[BRINE_PROPERTIES]
salinity = 0.1
reference_density = 1045.0
reference_viscosity = 0.0005

[RELATIVE_PERMEABILITY]
model = BROOKS_COREY
swc = 0.32
sgr = 0.10
krw_max = 0.60
krg_max = 0.40
nw = 4.0
ng = 2.0
enable_hysteresis = true
land_parameter = 1.5

[CAPILLARY_PRESSURE]
model = VAN_GENUCHTEN
entry_pressure = 3000.0
lambda = 0.8

[IC1]
field = PRESSURE
distribution = GRADIENT
reference_value = 13.0e6
reference_depth = 1000.0
gradient = 0, 0, -10000

[IC2]
field = SATURATION_WATER
distribution = UNIFORM
value = 1.0

[IC3]
field = TEMPERATURE
distribution = GRADIENT
reference_value = 323.15
reference_depth = 1000.0
gradient = 0, 0, -0.03

[WELL1]
name = CO2_INJECTOR
type = INJECTOR
x = 900.0
z_top = 300.0
z_bottom = 350.0
control_mode = RATE
target_value = 0.005
injection_fluid = CO2
max_bhp = 30.0e6

[BC1]
type = NO_FLOW
location = ZMAX

[BC2]
type = NO_FLOW
location = ZMIN

[BC3]
type = NO_FLOW
location = XMIN

[BC4]
type = DIRICHLET
location = XMAX
field = PRESSURE
value = 10.0e6

[SOLVER]
method = IMPLICIT
newton_max_iterations = 25
newton_tolerance = 1.0e-6
