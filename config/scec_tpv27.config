# =============================================================================
# SCEC TPV27: Thermal Pressurization - Heterogeneous Stress
# =============================================================================
# Reference: https://strike.scec.org/cvws/tpv26_27docs.html
#
# Same as TPV26 but with heterogeneous initial stress distribution.
# =============================================================================

[SIMULATION]
name = scec_tpv27
description = SCEC TPV27 - Thermal Pressurization Heterogeneous
dimension = 3
physics = ELASTODYNAMICS
time_integration = EXPLICIT

start_time = 0.0
end_time = 12.0
dt = 0.001
output_frequency = 100
output_dir = output/scec_tpv27
output_format = HDF5

[GRID]
nx = 301
ny = 151
nz = 151
Lx = 30000.0
Ly = 15000.0
Lz = 15000.0
dx = 100.0
dy = 100.0
dz = 100.0

[MATERIAL]
type = ELASTIC_HOMOGENEOUS
density = 2670.0
vp = 6000.0
vs = 3464.0

[FAULT1]
name = main_fault
type = STRIKE_SLIP
geometry = PLANAR
strike = 0.0
dip = 90.0
length = 30000.0
width = 15000.0
center = 15000.0, 0.0, 7500.0

# Rate-state friction with thermal pressurization
friction_model = RATE_STATE_THERMAL_PRESSURIZATION
reference_friction = 0.6
reference_velocity = 1.0e-6
direct_effect_a = 0.016
evolution_effect_b = 0.020
state_evolution_distance = 0.01

# Thermal pressurization parameters
thermal_diffusivity = 1.0e-6
hydraulic_diffusivity = 1.0e-4
shear_zone_width = 0.001
specific_heat = 900.0
fluid_compressibility = 4.0e-10
thermal_expansion = 3.0e-4

initial_pore_pressure = 40.0e6

# Heterogeneous initial stress
stress_model = HETEROGENEOUS
stress_field_file = data/tpv27_stress.dat
# Fallback: stochastic heterogeneity
stress_heterogeneity = STOCHASTIC
correlation_length = 1000.0
stress_std_dev = 5.0e6

# Base stress
normal_stress = -120.0e6
shear_stress_along_strike = 70.0e6

# Nucleation
nucleation_type = TIME_WEAKENING
nucleation_center = 15000.0, 0.0, 7500.0
nucleation_radius = 3000.0
nucleation_time = 0.5

[BC1]
type = FREE_SURFACE
location = ZMIN

[BC2]
type = ABSORBING
location = XMIN

[BC3]
type = ABSORBING
location = XMAX

[BC4]
type = ABSORBING
location = YMIN

[BC5]
type = ABSORBING
location = YMAX

[BC6]
type = ABSORBING
location = ZMAX

[RECEIVER1]
type = FAULT
location = 0.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, pore_pressure, temperature

[RECEIVER2]
type = FAULT
location = 4500.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, pore_pressure, temperature

[RECEIVER3]
type = FAULT
location = 9000.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, pore_pressure, temperature

[SOLVER]
method = EXPLICIT
cfl = 0.5
