# PyLith-Style Kinematic Fault Configuration
# 
# This configuration demonstrates a kinematic (prescribed slip) fault
# modeling a strike-slip earthquake with circular rupture propagation.
# Based on PyLith's FaultCohesiveKin implementation.
#
# Reference: SCEC/USGS benchmark problem TPV3 (simplified)
#
# Key features:
# - Cohesive cell representation for fault interface
# - Lagrange multipliers for slip constraints
# - Brune slip time function for realistic slip history
# - Circular rupture propagation from hypocenter

[SIMULATION]
name = pylith_kinematic_strike_slip
physics_type = ELASTODYNAMICS
start_time = 0.0
end_time = 12.0
dt_initial = 0.005
dt_min = 0.001
dt_max = 0.01

# Enable fault modeling
enable_faults = true
fault_implementation = PYLITH_COHESIVE

# Time integration
time_integrator = NEWMARK
newmark_beta = 0.25
newmark_gamma = 0.5
rtol = 1.0e-8
atol = 1.0e-10

[GRID]
# Domain: 60 km × 60 km × 30 km
nx = 121
ny = 121
nz = 61
Lx = 60000.0
Ly = 60000.0
Lz = 30000.0
origin_x = -30000.0
origin_y = -30000.0
origin_z = -30000.0

[MATERIAL]
# Elastic half-space properties
constitutive_model = LINEAR_ELASTIC
density = 2700.0
youngs_modulus = 70.0e9
poisson_ratio = 0.25
shear_modulus = 28.0e9
p_wave_velocity = 5770.0
s_wave_velocity = 3333.0

#==============================================================================
# PYLITH-STYLE KINEMATIC FAULT
#==============================================================================
[FAULT_KINEMATIC]
name = main_fault
fault_type = kinematic
implementation = pylith_cohesive

# Fault geometry
# Vertical strike-slip fault in YZ plane (x=0)
x = 0.0
y = 0.0
z = -7500.0
strike = 0.0
dip = 90.0
length = 30000.0
width = 15000.0

# Fault mesh discretization
fault_mesh_nx = 61
fault_mesh_nz = 31

# Cohesive cell properties
use_cohesive_cells = true
use_lagrange_multipliers = true

# Slip time function
slip_time_fn = brune
rise_time = 1.0
characteristic_time = 0.4

# Hypocenter and rupture propagation
hypocenter_x = 0.0
hypocenter_y = 0.0
hypocenter_z = -7500.0
rupture_velocity = 2800.0

# Slip distribution
# Uniform slip with circular expansion from hypocenter
slip_distribution = circular_rupture
final_slip_ll = 2.0
final_slip_reverse = 0.0
final_slip_opening = 0.0
rake = 180.0

# Alternative: spatially variable slip from file
# slip_distribution = from_file
# slip_file = slip_distribution.dat

[FAULT_OUTPUT]
format = VTK
path = output/pylith_kinematic
frequency = 20
fields = slip, slip_rate, traction

#==============================================================================
# ALTERNATIVE: STEP SLIP TIME FUNCTION
# Use for testing or instantaneous slip
#==============================================================================
# slip_time_fn = step

#==============================================================================
# ALTERNATIVE: LIU SLIP TIME FUNCTION
# Smoother than Brune, better for large earthquakes
#==============================================================================
# slip_time_fn = liu
# rise_time = 2.0

#==============================================================================
# ALTERNATIVE: CONSTANT RATE (CREEPING FAULT)
#==============================================================================
# slip_time_fn = constant_rate
# slip_rate = 3.17e-10  # 10 mm/year

[BC_ABSORBING]
# Absorbing boundaries on domain edges
location = XMIN, XMAX, YMIN, YMAX, ZMIN
type = ABSORBING
damping = stacey

[BC_SURFACE]
# Free surface at z = 0
location = ZMAX
type = FREE_SURFACE

[IC]
# Initial conditions (at rest)
displacement = 0.0, 0.0, 0.0
velocity = 0.0, 0.0, 0.0

[OUTPUT]
format = VTK
path = output/pylith_kinematic
frequency = 50

# Volume fields
displacement = true
velocity = true
stress = true
strain = true

# Receiver locations for time series
receivers = receivers_surface.dat, receivers_borehole.dat
receiver_output_format = ASCII
receiver_fields = displacement, velocity, acceleration

#==============================================================================
# Receiver definition file format:
# x y z [name]
# Example receivers_surface.dat:
#   0.0 5000.0 0.0 STA01
#   0.0 10000.0 0.0 STA02
#   5000.0 5000.0 0.0 STA03
#==============================================================================

[ANALYSIS]
# Post-processing
compute_moment = true
compute_moment_rate = true
output_catalog = true
catalog_file = output/pylith_kinematic/event_catalog.csv
