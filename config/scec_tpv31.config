# =============================================================================
# SCEC TPV31: Friction Heterogeneity
# =============================================================================
# Reference: https://strike.scec.org/cvws/tpv31docs.html
#
# Dynamic rupture with spatially heterogeneous friction properties.
# Tests effects of friction parameter heterogeneity on rupture behavior.
# =============================================================================

[SIMULATION]
name = scec_tpv31
description = SCEC TPV31 - Friction Heterogeneity
dimension = 3
physics = ELASTODYNAMICS
time_integration = EXPLICIT

start_time = 0.0
end_time = 12.0
dt = 0.002
output_frequency = 50
output_dir = output/scec_tpv31
output_format = HDF5

[GRID]
nx = 301
ny = 151
nz = 151
Lx = 30000.0
Ly = 15000.0
Lz = 15000.0
dx = 100.0
dy = 100.0
dz = 100.0

[MATERIAL]
type = ELASTIC_HOMOGENEOUS
density = 2670.0
vp = 6000.0
vs = 3464.0

[FAULT1]
name = main_fault
type = STRIKE_SLIP
geometry = PLANAR
strike = 0.0
dip = 90.0
length = 30000.0
width = 15000.0
center = 15000.0, 0.0, 7500.0

# Heterogeneous friction
friction_model = SLIP_WEAKENING_HETEROGENEOUS

# Base friction values
base_static_friction = 0.677
base_dynamic_friction = 0.525
base_Dc = 0.40

# Heterogeneity parameters
friction_heterogeneity = STOCHASTIC
random_seed = 54321
correlation_length = 1500.0
static_friction_std = 0.08
dynamic_friction_std = 0.06
Dc_std_fraction = 0.20

# Barrier patches (high friction)
[BARRIER1]
center = 7500.0, 0.0, 7500.0
radius = 2000.0
static_friction = 1.0
dynamic_friction = 0.8
Dc = 0.80

[BARRIER2]
center = 22500.0, 0.0, 7500.0
radius = 2000.0
static_friction = 1.0
dynamic_friction = 0.8
Dc = 0.80

# Initial stress (homogeneous)
normal_stress = -120.0e6
shear_stress_along_strike = 70.0e6

# Nucleation
nucleation_type = OVERSTRESSED_PATCH
nucleation_center = 15000.0, 0.0, 7500.0
nucleation_radius = 1500.0
nucleation_shear_stress = 81.6e6

[BC1]
type = FREE_SURFACE
location = ZMIN

[BC2]
type = ABSORBING
location = XMIN

[BC3]
type = ABSORBING
location = XMAX

[BC4]
type = ABSORBING
location = YMIN

[BC5]
type = ABSORBING
location = YMAX

[BC6]
type = ABSORBING
location = ZMAX

[RECEIVER1]
type = FAULT
location = 0.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, friction_coefficient

[RECEIVER2]
type = FAULT
location = 7500.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, friction_coefficient

[RECEIVER3]
type = FAULT
location = 15000.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, friction_coefficient

[RECEIVER4]
type = FAULT
location = 22500.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, friction_coefficient

[RECEIVER5]
type = FAULT
location = 30000.0, 0.0, 7500.0
output_fields = slip, slip_rate, shear_stress, friction_coefficient

[SOLVER]
method = EXPLICIT
cfl = 0.5
