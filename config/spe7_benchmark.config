# =============================================================================
# SPE7 Benchmark Configuration
# Horizontal Well Problem
# =============================================================================
#
# Reference: Nghiem, L.X. et al., SPE 21221 (1991)
#
# Tests horizontal well modeling:
# - Horizontal well trajectory
# - Near-wellbore inflow modeling (Peaceman)
# - Heterogeneous permeability
# - Productivity index calculations
#
# Grid: 9x9x6 = 486 cells
# Duration: 900 days
#
# =============================================================================

[SIMULATION]
name = spe7_horizontal_well
description = SPE7 - Horizontal Well Modeling
physics = TWO_PHASE_FLOW
fluid_model = BLACK_OIL

start_time = 0.0
end_time = 900.0
dt_initial = 0.1
dt_max = 10.0
time_unit = days

output_dir = output/spe7
output_format = HDF5
output_frequency = 9

[GRID]
nx = 9
ny = 9
nz = 6
Lx = 2743.2
Ly = 2743.2
Lz = 36.576
# Cell size: 304.8 x 304.8 x 6.096 m

[ROCK]
# Heterogeneous permeability
permeability_type = HETEROGENEOUS
porosity = 0.25
compressibility = 4.35e-10

# Layer permeabilities (mD)
[LAYER1]
k_layers = 1, 2
permeability_x = 200.0
permeability_y = 200.0
permeability_z = 20.0

[LAYER2]
k_layers = 3, 4
permeability_x = 500.0
permeability_y = 500.0
permeability_z = 50.0

[LAYER3]
k_layers = 5, 6
permeability_x = 100.0
permeability_y = 100.0
permeability_z = 10.0

[FLUID]
# Black oil properties
oil_density = 850.0
oil_viscosity = 0.003
oil_formation_volume_factor = 1.2
oil_compressibility = 1.5e-9

water_density = 1020.0
water_viscosity = 0.0005
water_formation_volume_factor = 1.01
water_compressibility = 4.5e-10

solution_gas_oil_ratio = 150.0
gas_gravity = 0.7

[RELATIVE_PERMEABILITY]
model = COREY
swc = 0.22
sor = 0.20
krw_max = 0.35
kro_max = 0.85
nw = 3.0
no = 2.5

[IC1]
field = PRESSURE
distribution = UNIFORM
value = 27.58e6

[IC2]
field = SATURATION_WATER
distribution = UNIFORM
value = 0.22

# Horizontal producer
[WELL1]
name = HORIZONTAL_PROD
type = PRODUCER
well_type = HORIZONTAL

# Trajectory: from (5,5,4) to (5,5,4) along i-direction
heel_i = 2
heel_j = 5
heel_k = 4
toe_i = 8
toe_j = 5
toe_k = 4

wellbore_radius = 0.1
skin = 0.0
control_mode = RATE
target_value = 0.023
min_bhp = 10.0e6

# Peaceman well model
well_model = PEACEMAN
direction = I

# Water injector (vertical)
[WELL2]
name = WATER_INJ
type = INJECTOR
well_type = VERTICAL
i = 1
j = 1
k = 1, 2, 3, 4, 5, 6
wellbore_radius = 0.1
control_mode = RATE
target_value = 0.020
injection_fluid = WATER
max_bhp = 40.0e6

[BC1]
type = NO_FLOW
location = ALL

[SOLVER]
method = IMPLICIT
newton_max_iterations = 15
newton_tolerance = 1.0e-5
