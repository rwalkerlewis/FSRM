# =============================================================================
# SPE6 Benchmark Configuration
# Dual-Porosity / Dual-Permeability Problem
# =============================================================================
#
# Reference: Firoozabadi, A. and Thomas, L.K., JPT (1990)
#
# Tests naturally fractured reservoir simulation:
# - Dual-porosity / dual-permeability formulation
# - Matrix-fracture transfer functions
# - Kazemi shape factor
#
# Grid: 10x1x5 = 50 cells
# Duration: 1000 days (waterflood)
#
# =============================================================================

[SIMULATION]
name = spe6_dual_porosity
description = SPE6 - Dual-Porosity Reservoir
physics = TWO_PHASE_FLOW
fluid_model = BLACK_OIL
enable_dual_porosity = true

start_time = 0.0
end_time = 1000.0
dt_initial = 0.1
dt_max = 10.0
time_unit = days

output_dir = output/spe6
output_format = HDF5
output_frequency = 10

[GRID]
nx = 10
ny = 1
nz = 5
Lx = 1000.0
Ly = 100.0
Lz = 50.0

# Dual-porosity model
[DUAL_POROSITY]
model = DUAL_PERMEABILITY
shape_factor_model = KAZEMI

# Matrix properties
[ROCK_MATRIX]
porosity = 0.20
permeability_x = 1.0
permeability_y = 1.0
permeability_z = 0.1
compressibility = 4.35e-10
block_size_x = 10.0
block_size_y = 10.0
block_size_z = 5.0

# Fracture properties
[ROCK_FRACTURE]
porosity = 0.01
permeability_x = 1000.0
permeability_y = 1000.0
permeability_z = 100.0
compressibility = 1.0e-9

# Transfer function
[TRANSFER]
type = KAZEMI
sigma = 0.12
gravity_drainage = true

[FLUID]
oil_density = 800.0
oil_viscosity = 0.002
oil_compressibility = 1.0e-9
water_density = 1000.0
water_viscosity = 0.001
water_compressibility = 4.5e-10

[RELATIVE_PERMEABILITY]
model = COREY
matrix_swc = 0.20
matrix_sor = 0.30
matrix_krw_max = 0.30
matrix_kro_max = 0.80
matrix_nw = 2.0
matrix_no = 2.0
fracture_swc = 0.01
fracture_sor = 0.01
fracture_krw_max = 1.0
fracture_kro_max = 1.0

[IC1]
field = PRESSURE
distribution = UNIFORM
value = 30.0e6

[IC2]
field = SATURATION_WATER
distribution = UNIFORM
value = 0.20

[WELL1]
name = WATER_INJECTOR
type = INJECTOR
i = 1
j = 1
k = 1, 2, 3, 4, 5
control_mode = RATE
target_value = 0.01
injection_fluid = WATER

[WELL2]
name = PRODUCER
type = PRODUCER
i = 10
j = 1
k = 1, 2, 3, 4, 5
control_mode = BHP
target_value = 15.0e6

[BC1]
type = NO_FLOW
location = ALL

[SOLVER]
method = IMPLICIT
newton_max_iterations = 15
newton_tolerance = 1.0e-5
