# =============================================================================
# SPE4 Benchmark Configuration
# Equation of State Testing Problem
# =============================================================================
#
# Reference: Whitson & Brul√©, "Phase Behavior", SPE (2000)
#
# Tests cubic equation of state implementations:
# - Peng-Robinson EOS
# - Multi-component flash calculations
# - Phase envelope computations
#
# =============================================================================

[SIMULATION]
name = spe4_eos
description = SPE4 - Equation of State Testing
physics = COMPOSITIONAL
fluid_model = COMPOSITIONAL

start_time = 0.0
end_time = 365.0
dt_initial = 0.1
dt_max = 10.0
time_unit = days

output_dir = output/spe4
output_format = HDF5
output_frequency = 36

[GRID]
nx = 10
ny = 10
nz = 3
Lx = 1000.0
Ly = 1000.0
Lz = 30.0

[ROCK]
porosity = 0.20
permeability_x = 100.0
permeability_y = 100.0
permeability_z = 10.0
compressibility = 4.35e-10

[EOS]
# Peng-Robinson Equation of State
type = PENG_ROBINSON
number_components = 6

# Component properties
[COMPONENT1]
name = CO2
molecular_weight = 44.01
critical_temperature = 304.2
critical_pressure = 7.38e6
acentric_factor = 0.225
parachor = 78.0

[COMPONENT2]
name = N2
molecular_weight = 28.01
critical_temperature = 126.2
critical_pressure = 3.40e6
acentric_factor = 0.040
parachor = 41.0

[COMPONENT3]
name = C1
molecular_weight = 16.04
critical_temperature = 190.6
critical_pressure = 4.60e6
acentric_factor = 0.008
parachor = 77.0

[COMPONENT4]
name = C2-C3
molecular_weight = 36.0
critical_temperature = 330.0
critical_pressure = 4.55e6
acentric_factor = 0.120
parachor = 120.0

[COMPONENT5]
name = C4-C6
molecular_weight = 72.0
critical_temperature = 450.0
critical_pressure = 3.50e6
acentric_factor = 0.220
parachor = 220.0

[COMPONENT6]
name = C7+
molecular_weight = 180.0
critical_temperature = 650.0
critical_pressure = 2.10e6
acentric_factor = 0.450
parachor = 500.0

# Binary interaction parameters
[BIP]
CO2-C1 = 0.12
CO2-C2-C3 = 0.12
CO2-C4-C6 = 0.12
CO2-C7+ = 0.10
N2-C1 = 0.02
N2-C7+ = 0.10

# Initial composition (mole fraction)
[IC_COMPOSITION]
CO2 = 0.02
N2 = 0.01
C1 = 0.50
C2-C3 = 0.15
C4-C6 = 0.12
C7+ = 0.20

[IC1]
field = PRESSURE
distribution = UNIFORM
value = 25.0e6

[IC2]
field = TEMPERATURE
distribution = UNIFORM
value = 373.0

[WELL1]
name = INJECTOR
type = INJECTOR
i = 1
j = 1
k = 1, 2, 3
control_mode = RATE
target_value = 0.001
injection_fluid = GAS
injection_composition = 1.0, 0.0, 0.0, 0.0, 0.0, 0.0

[WELL2]
name = PRODUCER
type = PRODUCER
i = 10
j = 10
k = 1, 2, 3
control_mode = BHP
target_value = 15.0e6

[SOLVER]
method = IMPLICIT
newton_max_iterations = 15
newton_tolerance = 1.0e-6
linear_solver = GMRES
preconditioner = ILU
