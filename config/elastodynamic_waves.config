# Elastodynamic Wave Propagation Configuration
# Full dynamic simulation with wave propagation and inertia

[SIMULATION]
start_time = 0.0
end_time = 10.0                       # 10 seconds of wave propagation
dt_initial = 0.0001                   # 0.1 ms for wave resolution
dt_min = 0.00001                      # 0.01 ms
dt_max = 0.001                        # 1 ms
max_timesteps = 100000

output_frequency = 100                # Frequent output for wave visualization
output_format = HDF5                  # HDF5 (default), VTK (secondary)
enable_checkpointing = true
checkpoint_frequency = 1000

rtol = 1.0e-6
atol = 1.0e-8
max_nonlinear_iterations = 20
max_linear_iterations = 1000

fluid_model = SINGLE_COMPONENT
solid_model = ELASTODYNAMIC           # Full dynamic elasticity

enable_geomechanics = true
enable_elastodynamics = false         # Already enabled via solid_model
enable_thermal = false
enable_fractures = false
enable_particle_transport = false
enable_faults = false
enable_tidal_forces = false

# Dynamic mode settings
use_dynamic_mode = true               # Full dynamics with inertia
use_static_triggering = false         # Not using static triggering
adaptive_timestepping = true

[GRID]
nx = 100
ny = 100
nz = 50

# Domain: 1 km x 1 km x 500 m
Lx = 1000.0
Ly = 1000.0
Lz = 500.0

use_unstructured = true              # All grids use DMPlex

[ROCK]
# Granite properties for wave propagation
porosity = 0.01                       # Low porosity (1%)
permeability_x = 0.001                # Very low permeability
permeability_y = 0.001
permeability_z = 0.0005

compressibility = 5.0e-11             # Very stiff

# Mechanical properties
youngs_modulus = 50.0e9               # 50 GPa (granite)
poisson_ratio = 0.25
density = 2700.0                      # kg/mÂ³

# Wave propagation properties
p_wave_velocity = 5500.0              # m/s (typical for granite)
s_wave_velocity = 3200.0              # m/s
quality_factor = 200.0                # High Q (low attenuation)

# Rayleigh damping for numerical stability
damping_alpha = 0.001                 # Mass proportional
damping_beta = 0.0001                 # Stiffness proportional

# Not using permeability dynamics in pure elastodynamics
permeability_strain_coeff = 0.0
permeability_stress_coeff = 0.0
min_permeability = 0.001
max_permeability = 1.0

[FLUID]
# Minimal fluid (dry rock approximation)
density = 1.0
viscosity = 1.0e-5
compressibility = 1.0e-10

[BC1]
# Free surface at top
type = NEUMANN
field = DISPLACEMENT
location = ZMAX
value = 0.0
gradient = 0.0

[BC2]
# Absorbing boundary at bottom (prevent reflections)
type = ROBIN
field = DISPLACEMENT
location = ZMIN
value = 0.0
gradient = 0.0

[BC3]
# Absorbing boundaries on sides
type = ROBIN
field = DISPLACEMENT
location = XMIN
value = 0.0

[BC4]
type = ROBIN
field = DISPLACEMENT
location = XMAX
value = 0.0

[BC5]
type = ROBIN
field = DISPLACEMENT
location = YMIN
value = 0.0

[BC6]
type = ROBIN
field = DISPLACEMENT
location = YMAX
value = 0.0

[IC1]
# Initial displacement (point source at depth)
field = DISPLACEMENT
distribution = UNIFORM
value = 0.0

[IC2]
# Initial velocity (impulse)
field = VELOCITY
distribution = UNIFORM
value = 0.0
