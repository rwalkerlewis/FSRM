# ==============================================================================
# 2D Coupled Reservoir Simulation Configuration
# ==============================================================================
# Demonstrates coupled flow and geomechanics:
# - Single-phase compressible flow
# - Linear poroelasticity
# - Subsidence from pressure depletion
# - Permeability changes from compaction
#
# Usage: mpirun -np 4 fsrm -c config/coupled_reservoir_2d.config
# ==============================================================================

[SIMULATION]
name = coupled_reservoir_2d
start_time = 0.0
end_time = 31536000.0                 # 1 year in seconds
dt_initial = 3153600.0                # ~36.5 days
dt_min = 86400.0                      # 1 day
dt_max = 2592000.0                    # 30 days
max_timesteps = 100
output_frequency = 5

# Single phase with geomechanics
fluid_model = SINGLE_COMPONENT
solid_model = POROELASTIC

# Enable coupled physics
enable_geomechanics = true
enable_thermal = false
enable_fractures = false

# Solver settings
rtol = 1.0e-6
atol = 1.0e-8
max_nonlinear_iterations = 50
max_linear_iterations = 1000

[GRID]
nx = 150
ny = 60
nz = 1
Lx = 500.0                            # 500 m
Ly = 200.0                            # 200 m
Lz = 10.0                             # 10 m (2D approximation)

mesh_type = CARTESIAN
use_unstructured = false

[ROCK]
constitutive_model = POROELASTIC

# Flow properties
porosity = 0.20                       # 20%
permeability_x = 100.0                # 100 mD
permeability_y = 100.0
permeability_z = 100.0
compressibility = 1.0e-9              # 1/Pa

# Mechanical properties
youngs_modulus = 10.0e9               # 10 GPa
poisson_ratio = 0.25
density = 2500.0                      # kg/m³
biot_coefficient = 0.7                # Biot coefficient

# Permeability model (stress-dependent)
permeability_model = EXPONENTIAL
permeability_stress_coeff = 1.0e-8    # Stress sensitivity

[FLUID]
type = SINGLE_PHASE
density = 1000.0                      # kg/m³ (water)
viscosity = 0.001                     # Pa·s (1 cP)
compressibility = 4.5e-10             # 1/Pa

[WELL1]
name = INJ1
type = INJECTOR
i = 30                                # At x = 100 m
j = 30                                # At y = 100 m
k = 0
control_mode = BHP
target_value = 35.0e6                 # 35 MPa (5 MPa overpressure)
fluid = WATER
diameter = 0.1

[WELL2]
name = PROD1
type = PRODUCER
i = 120                               # At x = 400 m
j = 15                                # At y = 50 m
k = 0
control_mode = BHP
target_value = 20.0e6                 # 20 MPa (10 MPa drawdown)
diameter = 0.1

[WELL3]
name = PROD2
type = PRODUCER
i = 120                               # At x = 400 m
j = 45                                # At y = 150 m
k = 0
control_mode = BHP
target_value = 20.0e6                 # 20 MPa (10 MPa drawdown)
diameter = 0.1

[BC1]
type = DIRICHLET
field = PRESSURE
location = XMIN
value = 30.0e6                        # 30 MPa boundary pressure

[BC2]
type = DIRICHLET
field = PRESSURE
location = XMAX
value = 30.0e6                        # 30 MPa boundary pressure

[BC3]
type = NEUMANN
field = DISPLACEMENT
location = ZMAX
value = 0.0                           # Free surface (no overburden stress)

[BC4]
type = DIRICHLET
field = DISPLACEMENT
location = ZMIN
value = 0.0                           # Fixed base

[IC1]
field = PRESSURE
distribution = UNIFORM
value = 30.0e6                        # 30 MPa initial pressure

[OUTPUT]
format = VTK
path = output/coupled_2d
frequency = 5
pressure = true
displacement = true
stress = false
strain = false
permeability = true
