# =============================================================================
# SPE8 Benchmark Configuration
# Gridding and Upscaling Problem
# =============================================================================
#
# Reference: Odeh, A.S. and Heinemann, Z.E., SPE (1994)
#
# Tests grid sensitivity and upscaling:
# - Multiple grid resolutions
# - Upscaling effects on flow
# - Numerical dispersion analysis
# - Corner-point grid support
#
# Fine grid: 40x40x3 = 4800 cells
# Coarse grid: 10x10x3 = 300 cells (for comparison)
#
# Duration: 1500 days (waterflood)
#
# =============================================================================

[SIMULATION]
name = spe8_gridding
description = SPE8 - Gridding and Upscaling
physics = TWO_PHASE_FLOW
fluid_model = BLACK_OIL

start_time = 0.0
end_time = 1500.0
dt_initial = 0.1
dt_max = 15.0
time_unit = days

output_dir = output/spe8
output_format = HDF5
output_frequency = 10

[GRID]
# Fine grid resolution
nx = 40
ny = 40
nz = 3

Lx = 4000.0
Ly = 4000.0
Lz = 30.0

# Grid type: Cartesian or corner-point
grid_type = CARTESIAN

[ROCK]
# Heterogeneous permeability field
permeability_type = HETEROGENEOUS

# Default (background) porosity
porosity = 0.22
compressibility = 4.35e-10

# High-permeability channel
[HIGH_PERM_ZONE]
type = CHANNEL
x_start = 0.0
x_end = 4000.0
y_start = 1500.0
y_end = 2500.0
permeability_x = 2000.0
permeability_y = 2000.0
permeability_z = 200.0

# Low-permeability background
[LOW_PERM_ZONE]
type = BACKGROUND
permeability_x = 100.0
permeability_y = 100.0
permeability_z = 10.0

# Or load from file:
# permeability_file = data/spe8_perm.dat

[FLUID]
oil_density = 850.0
oil_viscosity = 0.002
oil_formation_volume_factor = 1.15
oil_compressibility = 1.0e-9

water_density = 1025.0
water_viscosity = 0.0004
water_formation_volume_factor = 1.02
water_compressibility = 4.5e-10

[RELATIVE_PERMEABILITY]
model = COREY
swc = 0.20
sor = 0.25
krw_max = 0.30
kro_max = 0.90
nw = 2.5
no = 2.0

[IC1]
field = PRESSURE
distribution = UNIFORM
value = 25.0e6

[IC2]
field = SATURATION_WATER
distribution = UNIFORM
value = 0.20

# Five-spot pattern
[WELL1]
name = INJ_CENTER
type = INJECTOR
i = 20
j = 20
k = 1, 2, 3
control_mode = RATE
target_value = 0.03
injection_fluid = WATER

[WELL2]
name = PROD_NE
type = PRODUCER
i = 38
j = 38
k = 1, 2, 3
control_mode = BHP
target_value = 15.0e6

[WELL3]
name = PROD_NW
type = PRODUCER
i = 3
j = 38
k = 1, 2, 3
control_mode = BHP
target_value = 15.0e6

[WELL4]
name = PROD_SE
type = PRODUCER
i = 38
j = 3
k = 1, 2, 3
control_mode = BHP
target_value = 15.0e6

[WELL5]
name = PROD_SW
type = PRODUCER
i = 3
j = 3
k = 1, 2, 3
control_mode = BHP
target_value = 15.0e6

[BC1]
type = NO_FLOW
location = ALL

# Upscaling options
[UPSCALING]
enabled = false
method = FLOW_BASED
coarse_nx = 10
coarse_ny = 10
coarse_nz = 3

[SOLVER]
method = IMPLICIT
newton_max_iterations = 12
newton_tolerance = 1.0e-5
linear_solver = GMRES
preconditioner = ILU
