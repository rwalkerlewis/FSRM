# ==============================================================================
# Buckley-Leverett 2D Waterflooding Configuration
# ==============================================================================
# Classic immiscible two-phase displacement problem demonstrating:
# - Fractional flow theory
# - Shock front propagation
# - Saturation tracking
#
# Usage: mpirun -np 4 fsrm -c config/buckley_leverett_2d.config
# ==============================================================================

[SIMULATION]
name = buckley_leverett_2d
start_time = 0.0
end_time = 2592000.0                  # 30 days in seconds
dt_initial = 52000.0                  # ~14 hours
dt_min = 100.0
dt_max = 86400.0                      # 1 day max
max_timesteps = 100
output_frequency = 5

# Two-phase black oil model for immiscible flow
fluid_model = BLACK_OIL
solid_model = ELASTIC

# No coupling needed for simple displacement
enable_geomechanics = false
enable_thermal = false
enable_fractures = false

# Solver settings
rtol = 1.0e-6
atol = 1.0e-8
max_nonlinear_iterations = 30
max_linear_iterations = 500

[GRID]
# Elongated domain for 1D-like displacement
nx = 100
ny = 20
nz = 1
Lx = 100.0                            # 100 m length
Ly = 20.0                             # 20 m width
Lz = 1.0                              # 1 m height (2D problem)

mesh_type = CARTESIAN
use_unstructured = false

[ROCK]
porosity = 0.25                       # 25%
permeability_x = 100.0                # 100 mD
permeability_y = 100.0
permeability_z = 100.0
compressibility = 1.0e-9              # 1/Pa
density = 2500.0                      # kg/m³

[FLUID]
type = BLACK_OIL

# Water properties
water_density_std = 1000.0            # kg/m³
water_viscosity = 0.0005              # Pa·s (0.5 cP)

# Oil properties
oil_density_std = 850.0               # kg/m³
oil_viscosity = 0.002                 # Pa·s (2 cP)

# Relative permeability - Corey model
swc = 0.2                             # Connate water
sor = 0.2                             # Residual oil
corey_nw = 2.0                        # Water exponent
corey_no = 2.0                        # Oil exponent
krw_max = 1.0
kro_max = 1.0

# No gas
gas_density_std = 1.0
gas_viscosity = 0.00001
solution_gor = 0.0

[WELL1]
name = INJ1
type = INJECTOR
i = 0                                 # Left side injection
j = 10
k = 0
control_mode = RATE
target_value = 1.0e-5                 # m/s Darcy velocity
fluid = WATER
diameter = 0.1

[WELL2]
name = PROD1
type = PRODUCER
i = 99                                # Right side production
j = 10
k = 0
control_mode = BHP
target_value = 1.0e7                  # 10 MPa
diameter = 0.1

[BC1]
type = DIRICHLET
field = PRESSURE
location = XMIN
value = 12.0e6                        # 12 MPa injection pressure

[BC2]
type = DIRICHLET
field = PRESSURE
location = XMAX
value = 10.0e6                        # 10 MPa production pressure

[IC1]
field = PRESSURE
distribution = UNIFORM
value = 10.0e6                        # 10 MPa initial pressure

[IC2]
field = SATURATION_W
distribution = UNIFORM
value = 0.2                           # Connate water saturation

[OUTPUT]
format = VTK
path = output/buckley_leverett
frequency = 5
pressure = true
saturation = true
velocity = false
