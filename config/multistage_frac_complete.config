# =============================================================================
# Complete Multi-Stage Hydraulic Fracturing Configuration
# =============================================================================
# This configuration demonstrates ALL ResFrac-equivalent capabilities:
# - Multi-cluster, multi-stage fracturing
# - Limited-entry perforation design
# - Stress shadowing
# - 2D proppant transport with screenout prediction
# - Wellbore hydraulics with temperature
# - Diversion modeling
# - Real-time analysis
# - Flowback and production forecasting
# - Economic optimization
# - Fiber optic integration (DAS/DTS)
# =============================================================================

[SIMULATION]
name = multistage_unconventional_completion
start_time = 0.0
end_time = 604800.0               # 7 days (treatment + initial flowback)
dt_initial = 1.0                  # 1 second during treatment
dt_min = 0.1
dt_max = 60.0
output_frequency = 10
output_format = HDF5

# Physics modes
fluid_model = SINGLE_COMPONENT
solid_model = POROELASTIC
enable_geomechanics = true
enable_thermal = true
enable_fractures = true
enable_multistage = true
enable_proppant_transport = true
enable_stress_shadowing = true
enable_diversion = false
enable_fiber_optic = true
enable_real_time_analysis = true
enable_economic_analysis = true

# Solver settings
rtol = 1.0e-6
atol = 1.0e-8
max_nonlinear_iterations = 50

# =============================================================================
# WELL GEOMETRY
# =============================================================================

[WELL]
name = PERMIAN_HZ_1
well_type = HORIZONTAL
total_md = 6096.0                 # 20,000 ft total MD
vertical_depth = 2438.4           # 8,000 ft TVD
lateral_length = 3048.0           # 10,000 ft lateral
kickoff_depth = 2133.6            # 7,000 ft KOP
landing_zone_tvd = 2438.4         # 8,000 ft TVD

# Wellbore geometry
casing_id = 0.1143                # 4.5" ID casing
casing_od = 0.127                 # 5" OD
tubing_id = 0.0762                # 3" tubing (if used)
roughness = 0.0001524             # Pipe roughness (m)

# Completion type
completion_type = PLUG_AND_PERF

# =============================================================================
# STRESS PROFILE (along wellbore TVD)
# =============================================================================

[STRESS_PROFILE]
# Depth (m TVD), Shmin (Pa), SHmax (Pa), Sv (Pa), Pp (Pa)
profile_data = """
2400.0, 38.0e6, 42.0e6, 52.0e6, 31.0e6
2420.0, 38.5e6, 42.5e6, 52.5e6, 31.2e6
2440.0, 39.0e6, 43.0e6, 53.0e6, 31.4e6
2460.0, 39.5e6, 43.5e6, 53.5e6, 31.6e6
2480.0, 40.0e6, 44.0e6, 54.0e6, 31.8e6
"""
stress_gradient_shmin = 16.3e3    # Pa/m (0.72 psi/ft)
stress_gradient_shmax = 18.1e3    # Pa/m (0.80 psi/ft)
stress_gradient_sv = 22.6e3       # Pa/m (1.0 psi/ft)
pore_pressure_gradient = 10.2e3   # Pa/m (0.45 psi/ft)

# =============================================================================
# ROCK PROPERTIES (by formation)
# =============================================================================

[ROCK]
formation_name = WOLFCAMP_A
porosity = 0.06                   # 6% porosity
permeability_x = 0.0001           # 100 nD
permeability_y = 0.0001
permeability_z = 0.00001          # 10 nD vertical
density = 2550.0
compressibility = 5.0e-10

# Mechanical properties
constitutive_model = POROELASTIC
youngs_modulus = 35.0e9           # 35 GPa
poisson_ratio = 0.22
biot_coefficient = 0.8

# Fracture properties
tensile_strength = 6.0e6          # 6 MPa
fracture_toughness = 1.2e6        # 1.2 MPa·√m
fracture_energy = 50.0            # J/m²

# Thermal properties
thermal_conductivity = 2.0        # W/m/K
heat_capacity = 850.0             # J/kg/K
thermal_expansion = 1.0e-5        # 1/K

# =============================================================================
# FLUID SYSTEMS
# =============================================================================

[FLUID_SLICKWATER]
name = Slickwater
type = SLICKWATER
density = 1000.0                  # kg/m³
base_viscosity = 0.001            # Pa·s (1 cP)
n_prime = 1.0                     # Newtonian
k_prime = 0.001
friction_reduction = 0.70         # 70% friction reduction
leakoff_coefficient = 6.0e-5      # m/√s (Carter coefficient)
spurt_loss = 0.0

[FLUID_LINEAR_GEL]
name = Linear_Gel_20lb
type = LINEAR_GEL
density = 1005.0
base_viscosity = 0.015            # 15 cP
n_prime = 0.65
k_prime = 0.5
friction_reduction = 0.3
leakoff_coefficient = 4.0e-5
breakdown_temperature = 393.15    # 120°C
breakdown_time = 7200.0           # 2 hours

[FLUID_CROSSLINKED]
name = Crosslinked_Borate_35lb
type = CROSSLINKED_GEL
density = 1010.0
base_viscosity = 0.100            # 100 cP
n_prime = 0.45
k_prime = 5.0
friction_reduction = 0.1
leakoff_coefficient = 2.0e-5
breakdown_temperature = 373.15
breakdown_time = 14400.0          # 4 hours

# =============================================================================
# PROPPANT SYSTEMS
# =============================================================================

[PROPPANT_100MESH]
name = 100_Mesh_Sand
type = SAND
diameter = 0.00015                # 150 micron
specific_gravity = 2.65
bulk_density = 1550.0
absolute_density = 2650.0
porosity = 0.38
sphericity = 0.65
roundness = 0.60
crush_strength = 28.0e6           # 4000 psi

# Permeability at stress (closure stress Pa, permeability m²)
permeability_data = """
14.0e6, 5.0e-10
28.0e6, 2.0e-10
42.0e6, 8.0e-11
56.0e6, 3.0e-11
"""

[PROPPANT_4070]
name = 40_70_White_Sand
type = SAND
diameter = 0.00030                # 300 micron
specific_gravity = 2.65
bulk_density = 1600.0
absolute_density = 2650.0
porosity = 0.35
sphericity = 0.70
roundness = 0.65
crush_strength = 42.0e6           # 6000 psi

permeability_data = """
14.0e6, 2.0e-9
28.0e6, 8.0e-10
42.0e6, 3.0e-10
56.0e6, 1.0e-10
"""

[PROPPANT_3050]
name = 30_50_Ceramic
type = CERAMIC_IDC
diameter = 0.00045                # 450 micron
specific_gravity = 3.20
bulk_density = 1850.0
absolute_density = 3200.0
porosity = 0.32
sphericity = 0.90
roundness = 0.85
crush_strength = 70.0e6           # 10000 psi

permeability_data = """
14.0e6, 1.0e-8
28.0e6, 6.0e-9
42.0e6, 3.0e-9
56.0e6, 1.5e-9
70.0e6, 8.0e-10
"""

# =============================================================================
# STAGE DESIGN - 30 Stages, 5 Clusters per Stage
# =============================================================================

[STAGE_DESIGN]
num_stages = 30
clusters_per_stage = 5
stage_spacing = 91.44             # 300 ft stage spacing
cluster_spacing = 15.24           # 50 ft cluster spacing

# Perforation design
perfs_per_cluster = 3
perforation_diameter = 0.0095     # 0.37" perfs
perforation_phasing = 60          # degrees
shot_density = 6                  # shots per foot

# Limited entry design
target_perf_friction = 5.5e6      # 800 psi target perf friction
discharge_coefficient = 0.85

# =============================================================================
# PUMP SCHEDULE (per stage)
# =============================================================================

[PUMP_SCHEDULE_TEMPLATE]
# Each stage uses this template, volumes scaled by stage efficiency

# Pad stage
pad_fluid = Slickwater
pad_volume = 190.0                # 190 m³ (1200 bbl)
pad_rate = 0.132                  # 0.132 m³/s (50 bpm)

# 100 mesh sweep
sweep_100mesh_fluid = Slickwater
sweep_100mesh_proppant = 100_Mesh_Sand
sweep_100mesh_volume = 95.0       # m³
sweep_100mesh_conc_start = 60.0   # kg/m³ (0.5 ppa)
sweep_100mesh_conc_end = 120.0    # kg/m³ (1.0 ppa)
sweep_100mesh_rate = 0.132

# Main proppant stages
main_fluid = Slickwater
main_proppant = 40_70_White_Sand
main_stages = """
volume_m3, concentration_kg_m3, rate_m3_s
95.0, 180.0, 0.132
95.0, 240.0, 0.132
95.0, 300.0, 0.132
95.0, 360.0, 0.132
95.0, 420.0, 0.132
95.0, 480.0, 0.120
95.0, 540.0, 0.120
"""

# Flush
flush_fluid = Slickwater
flush_volume = 32.0               # m³
flush_rate = 0.120

# Total per stage approximately:
# - 500 m³ fluid (3150 bbl)
# - 90,000 kg proppant (200,000 lbs)

# =============================================================================
# STRESS SHADOWING SETTINGS
# =============================================================================

[STRESS_SHADOWING]
enabled = true
calculation_method = RECTANGULAR_DDM  # or SNEDDON_PENNY
include_poroelastic = true
update_frequency = 1              # Update every stage

# Parent well effects (if applicable)
parent_well_present = false
parent_distance = 304.8           # 1000 ft
parent_depletion_pressure = 10.0e6

# =============================================================================
# PROPPANT TRANSPORT SETTINGS
# =============================================================================

[PROPPANT_TRANSPORT]
enabled = true
method = 2D_CONVECTION_SETTLING

# Grid resolution in fracture
nx_fracture = 100
nz_fracture = 50

# Settling model
hindered_settling = true
settling_exponent = 4.65          # Richardson-Zaki

# Screenout detection
screenout_threshold = 0.60        # Volume fraction for screenout
bridging_width_ratio = 3.0        # Width/diameter for bridging

# Bank formation
enable_bank_formation = true
bank_angle = 35.0                 # degrees

# =============================================================================
# WELLBORE HYDRAULICS
# =============================================================================

[WELLBORE_HYDRAULICS]
enabled = true

# Friction model
friction_correlation = HAALAND
drag_reduction_factor = 0.70

# Perforation erosion
enable_perf_erosion = true
erosion_coefficient = 1.0e-11

# Near-wellbore friction
include_tortuosity = true
tortuosity_coefficient = 0.1

# Temperature model
enable_temperature_model = true
surface_injection_temp = 293.15   # 20°C
geothermal_gradient = 0.025       # K/m

# =============================================================================
# DIVERSION (optional)
# =============================================================================

[DIVERSION]
enabled = false                   # Set to true if using diverters

diverter_type = PARTICULATE       # or BALL_SEALER, CHEMICAL
diverter_material = PLA           # Polylactic acid

# Particulate diverter properties
particle_diameter = 0.0008        # 800 micron
particle_density = 1200.0
degradation_half_life = 14400.0   # 4 hours at BHT
activation_temperature = 343.15   # 70°C

# Diverter schedule
diverter_stages = 2               # Add diverter after 2 proppant stages
diverter_concentration = 120.0    # kg/m³
diverter_volume = 2.0             # m³

# =============================================================================
# REAL-TIME ANALYSIS
# =============================================================================

[REAL_TIME_ANALYSIS]
enabled = true

# ISIP analysis
isip_detection_method = DERIVATIVE
isip_threshold = 0.01             # Derivative threshold

# Closure analysis
closure_method = G_FUNCTION       # or SQRT_TIME, LOG_LOG
g_function_smoothing = 3

# Net pressure monitoring
net_pressure_alert_high = 8.0e6   # Alert if > 8 MPa
net_pressure_alert_low = 1.0e6    # Alert if < 1 MPa

# Screenout prediction
screenout_predictor = true
screenout_warning_threshold = 0.8

# Geometry estimation
geometry_model = P3D              # or PKN, KGD, MATERIAL_BALANCE

# =============================================================================
# FLOWBACK AND PRODUCTION
# =============================================================================

[FLOWBACK]
enabled = true
start_after_treatment = 86400.0   # Start 24 hours after treatment
duration = 604800.0               # 7 days flowback

# Choke schedule
choke_schedule = """
time_hours, choke_size_fraction
0, 0.125
24, 0.25
72, 0.375
168, 0.5
"""

# Water recovery target
target_water_recovery = 0.30      # 30% load recovery

[PRODUCTION_FORECAST]
enabled = true
forecast_years = 30
decline_model = MODIFIED_HYPERBOLIC
economic_limit_oil = 0.05         # m³/day
economic_limit_gas = 280.0        # m³/day

# =============================================================================
# ECONOMIC ANALYSIS
# =============================================================================

[ECONOMICS]
enabled = true

# Commodity prices
oil_price = 75.0                  # $/bbl
gas_price = 3.50                  # $/mcf
ngl_price = 30.0                  # $/bbl
ngl_yield = 50.0                  # bbl NGL / MMcf gas

# Costs
drilling_cost_per_foot = 600.0    # $/ft
completion_cost_per_stage = 150000.0  # $/stage
proppant_cost_per_lb = 0.08       # $/lb
fluid_cost_per_bbl = 0.50         # $/bbl

# Operating costs
fixed_opex_monthly = 5000.0       # $/month
loe_per_boe = 8.0                 # $/BOE
water_disposal_cost = 1.00        # $/bbl

# Taxes and royalties
royalty_rate = 0.25               # 25%
severance_tax = 0.046             # 4.6%
ad_valorem_rate = 0.02            # 2%

# Economics parameters
discount_rate = 0.10              # 10% annual
working_interest = 1.0            # 100% WI

# =============================================================================
# FIBER OPTIC INTEGRATION
# =============================================================================

[FIBER_OPTIC]
enabled = true

# DAS settings
das_enabled = true
das_gauge_length = 10.0           # m
das_spatial_sampling = 1.0        # m
das_temporal_sampling = 1000.0    # Hz

# DTS settings
dts_enabled = true
dts_spatial_resolution = 1.0      # m
dts_temperature_resolution = 0.1  # K

# Analysis
cluster_efficiency_from_das = true
fracture_height_from_dts = true
flow_allocation_monitoring = true

# Cross-well monitoring (if applicable)
cross_well_monitoring = false
monitor_well_name = PERMIAN_HZ_2
monitor_well_distance = 304.8     # m

# =============================================================================
# OUTPUT SETTINGS
# =============================================================================

[OUTPUT]
format = HDF5                     # HDF5 or VTK
path = output/multistage_complete
frequency = 10

# Field outputs
output_pressure = true
output_displacement = true
output_stress = true
output_temperature = true
output_proppant_concentration = true
output_fracture_geometry = true

# Stage-by-stage reports
stage_reports = true
real_time_plots = true

# Economic reports
npv_sensitivity = true
tornado_chart = true
monte_carlo_runs = 1000

# =============================================================================
# BOUNDARY CONDITIONS
# =============================================================================

[BC1]
type = DIRICHLET
field = PRESSURE
location = FAR_FIELD
value = 31.0e6                    # Initial reservoir pressure

[BC2]
type = DIRICHLET
field = DISPLACEMENT
location = MODEL_BOUNDARY
value = 0.0                       # Fixed displacement at boundaries

# =============================================================================
# INITIAL CONDITIONS
# =============================================================================

[IC1]
field = PRESSURE
distribution = GRADIENT
value = 31.0e6
gradient = 0, 0, 10200            # Hydrostatic gradient

[IC2]
field = TEMPERATURE
distribution = GRADIENT
value = 293.15
gradient = 0, 0, 25               # Geothermal gradient
