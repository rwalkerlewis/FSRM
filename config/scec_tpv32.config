# =============================================================================
# SCEC TPV32: Normal Fault with Free Surface - Slip-Weakening
# =============================================================================
# Reference: https://strike.scec.org/cvws/tpv32_33docs.html
#
# 60-degree dipping normal fault reaching the free surface.
# Slip-weakening friction law.
# =============================================================================

[SIMULATION]
name = scec_tpv32
description = SCEC TPV32 - Normal Fault Free Surface
dimension = 3
physics = ELASTODYNAMICS
time_integration = EXPLICIT

start_time = 0.0
end_time = 12.0
dt = 0.002
output_frequency = 50
output_dir = output/scec_tpv32
output_format = HDF5

[GRID]
nx = 301
ny = 201
nz = 151
Lx = 30000.0
Ly = 20000.0
Lz = 15000.0
dx = 100.0
dy = 100.0
dz = 100.0

[MATERIAL]
type = ELASTIC_HOMOGENEOUS
density = 2670.0
vp = 6000.0
vs = 3464.0

[FAULT1]
name = normal_fault
type = NORMAL
geometry = PLANAR
strike = 0.0
dip = 60.0
surface_trace_y = 10000.0
fault_depth_extent = 15000.0

friction_model = SLIP_WEAKENING
static_friction = 0.60
dynamic_friction = 0.10
Dc = 0.50

# Depth-dependent stress
stress_model = DEPTH_DEPENDENT
surface_normal_stress = 0.0
normal_stress_gradient = -18000.0
surface_shear_stress = 0.0
shear_stress_gradient = 9800.0

nucleation_type = OVERSTRESSED_PATCH
nucleation_center = 15000.0, 10000.0, 12000.0
nucleation_radius = 1500.0
nucleation_stress_perturbation = 15.0e6

[BC1]
type = FREE_SURFACE
location = ZMIN

[BC2]
type = ABSORBING
location = XMIN

[BC3]
type = ABSORBING
location = XMAX

[BC4]
type = ABSORBING
location = YMIN

[BC5]
type = ABSORBING
location = YMAX

[BC6]
type = ABSORBING
location = ZMAX

# Surface receivers
[RECEIVER1]
type = BODY
location = 15000.0, 13000.0, 0.0
output_fields = velocity, displacement

[RECEIVER2]
type = BODY
location = 15000.0, 16000.0, 0.0
output_fields = velocity, displacement

[RECEIVER3]
type = BODY
location = 15000.0, 7000.0, 0.0
output_fields = velocity, displacement

[RECEIVER4]
type = BODY
location = 15000.0, 4000.0, 0.0
output_fields = velocity, displacement

# On-fault receivers
[RECEIVER5]
type = FAULT
location = 15000.0, 10000.0, 6000.0
output_fields = slip, slip_rate, shear_stress

[RECEIVER6]
type = FAULT
location = 15000.0, 10000.0, 12000.0
output_fields = slip, slip_rate, shear_stress

[SOLVER]
method = EXPLICIT
cfl = 0.5
