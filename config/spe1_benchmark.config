# ==============================================================================
# SPE1 Benchmark Configuration
# ==============================================================================
# First SPE Comparative Solution Project
# 3-phase black oil problem with gas dissolution
# 
# Reference: Odeh, A.S., "Comparison of Solutions to a Three-Dimensional
#            Black-Oil Reservoir Simulation Problem", JPT (1981)
#
# Usage: mpirun -np 4 fsrm -c config/spe1_benchmark.config
# ==============================================================================

[SIMULATION]
name = spe1_benchmark
start_time = 0.0
end_time = 315360000.0                # 10 years in seconds
dt_initial = 2592000.0                # 30 days initial
dt_min = 86400.0                      # 1 day min
dt_max = 7776000.0                    # 90 days max
max_timesteps = 500
output_frequency = 10

# Black oil 3-phase model
fluid_model = BLACK_OIL
solid_model = ELASTIC

# No coupling for benchmark comparison
enable_geomechanics = false
enable_thermal = false
enable_fractures = false

# Solver settings
rtol = 1.0e-6
atol = 1.0e-8
max_nonlinear_iterations = 50
max_linear_iterations = 1000

[GRID]
# SPE1 grid: 10x10x3
nx = 10
ny = 10
nz = 3
Lx = 304.8                            # 1000 ft in meters
Ly = 304.8                            # 1000 ft in meters
Lz = 6.096                            # 20 ft in meters

mesh_type = CARTESIAN
use_unstructured = false

[ROCK]
# Layer 1 (top)
porosity = 0.30                       # 30%
permeability_x = 500.0                # 500 mD
permeability_y = 500.0
permeability_z = 50.0                 # 10:1 anisotropy
compressibility = 4.35e-10            # 3e-6 psi^-1 in 1/Pa
density = 2650.0

[FLUID]
type = BLACK_OIL

# Stock tank conditions
oil_density_std = 849.0               # 53 lb/ft³ in kg/m³
gas_density_std = 0.9                 # Low pressure gas
water_density_std = 1038.0            # 64.79 lb/ft³ (with salinity)

# Viscosity
oil_viscosity = 0.00096               # 0.96 cP
gas_viscosity = 0.000016              # 0.016 cP
water_viscosity = 0.00031             # 0.31 cP

# PVT properties
solution_gor = 90.0                   # GOR at bubble point (sm³/sm³)
bubble_point_pressure = 4.85e6        # 703.5 psia in Pa
oil_compressibility = 1.45e-9         # 1e-5 psi^-1
pvt_correlation = STANDING

# Relative permeability
swc = 0.12                            # Connate water
sor = 0.20                            # Residual oil
sgc = 0.02                            # Critical gas
corey_nw = 2.0
corey_no = 2.0
corey_ng = 2.0

[WELL1]
# Producer at (10, 10, 3) - corner opposite injector
name = PRODUCER
type = PRODUCER
i = 9                                 # 0-indexed, so 9 = cell 10
j = 9
k = 2                                 # Bottom layer
control_mode = RATE
target_value = 6.178e-4               # 20,000 STB/day to m³/s
min_bhp = 6.895e6                     # 1000 psia
diameter = 0.1

[WELL2]
# Gas injector at (1, 1, 1) - corner
name = INJECTOR
type = INJECTOR
i = 0
j = 0
k = 0                                 # Top layer
control_mode = RATE
target_value = 3.089e-4               # 10,000 MSCF/day to m³/s
max_bhp = 68.95e6                     # 10,000 psia
fluid = GAS
diameter = 0.1

[BC1]
# No-flow boundaries (closed reservoir)
type = NEUMANN
field = PRESSURE
location = ALL
value = 0.0

[IC1]
field = PRESSURE
distribution = UNIFORM
value = 31.03e6                       # 4500 psia in Pa

[IC2]
field = SATURATION_W
distribution = UNIFORM
value = 0.12                          # Connate water

[IC3]
field = SATURATION_G
distribution = UNIFORM
value = 0.0                           # No free gas initially

[OUTPUT]
format = VTK
path = output/spe1
frequency = 10
pressure = true
saturation = true
