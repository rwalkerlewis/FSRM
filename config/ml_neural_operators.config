# =============================================================================
# Neural Operator Configuration
# =============================================================================
# Configures neural network-based PDE solvers:
# - FNO: Fourier Neural Operator (for regular grids)
# - GNO: Graph Neural Operator (for unstructured meshes)
# - DeepONet: Deep Operator Network (for parametric PDEs)
# - POD-ROM: Neural Reduced Order Models
# =============================================================================

[general]
enabled = true
model_directory = ml_models/operators
use_gpu = true
precision = float32

# =============================================================================
# Fourier Neural Operator (FNO)
# =============================================================================
[fno]
enabled = true
model_path = ml_models/operators/fno_model.pt

# Solver method
# Options: NUMERICAL_ONLY, FNO_ONLY, HYBRID_FNO_REFINE, ENSEMBLE
solver_method = HYBRID_FNO_REFINE

# Architecture
modes_x = 12
modes_y = 12
modes_z = 4
width = 64
num_layers = 4
activation = gelu

# Input/Output
input_channels = 3
output_channels = 3

# Training
learning_rate = 1e-3
weight_decay = 1e-4
batch_size = 8
epochs = 100
scheduler = cosine
warmup_epochs = 5

# Physics-informed options
physics_informed = true
physics_weight = 0.1
physics_equations = elastic

# Hybrid solver options
ensemble_weight = 0.5
refinement_iterations = 2
residual_threshold = 1e-6

# Data generation
generate_training_data = true
num_training_samples = 1000
parameter_variation = true
permeability_range = 1e-15,1e-12
porosity_range = 0.1,0.3

# Augmentation
use_augmentation = true
rotation = true
flip = true
noise_level = 0.01

# =============================================================================
# Graph Neural Operator (GNO)
# =============================================================================
[gno]
enabled = true
model_path = ml_models/operators/gno_model.pt

# GNO type
# Options: BASIC_GNO, MESH_GRAPH_NET, MULTIPOLE_GNN, PHYSICS_INFORMED_GNN
gno_type = BASIC_GNO

# Architecture
input_dim = 3
output_dim = 3
hidden_dim = 128
edge_dim = 64
num_layers = 6

# Layer type
# Options: BASIC, EDGE_CONV, GAT, TRANSFORMER
layer_type = GAT
num_heads = 4

# Training
learning_rate = 1e-3
weight_decay = 1e-5
batch_size = 4
epochs = 100

# Normalization
use_layer_norm = true
use_batch_norm = false

# Residual connections
use_residual = true
use_skip_connections = true

# Positional encoding
use_positional_encoding = true
pos_encoding_dim = 32

# =============================================================================
# Multi-scale GNO (Multipole)
# =============================================================================
[multipole_gno]
enabled = false
model_path = ml_models/operators/multipole_gno_model.pt

# Hierarchy
num_levels = 4
coarsening_ratio = 4
mp_steps_per_level = 2

# Up/downsampling
upsample_method = interpolate
downsample_method = pool

# =============================================================================
# POD-Neural ROM
# =============================================================================
[pod_rom]
enabled = true
model_path = ml_models/operators/pod_rom_model.pt

# ROM type
# Options: POD_NN, POD_LSTM, AUTOENCODER, DEEPONET
rom_type = POD_NN

# POD settings
num_modes = 50
energy_threshold = 0.999

# Neural dynamics network
hidden_layers = 256,256,256
activation = gelu
use_batch_norm = true

# Time integration
time_integrator = rk4

# Training
learning_rate = 1e-3
batch_size = 64
epochs = 200
weight_decay = 1e-4

# Physics-informed training
use_physics_loss = false
physics_weight = 0.1

# =============================================================================
# Autoencoder ROM
# =============================================================================
[autoencoder_rom]
enabled = false
model_path = ml_models/operators/autoencoder_rom_model.pt

# Encoder architecture
encoder_layers = 1000,500,100,20
latent_dim = 20

# Decoder (mirror if empty)
decoder_layers = 

# Activation
activation = gelu

# Variational
variational = false
kl_weight = 1e-3

# Dynamics
dynamics_layers = 64,64

# Training
learning_rate = 1e-3
epochs = 500
batch_size = 64

# =============================================================================
# DeepONet
# =============================================================================
[deeponet]
enabled = false
model_path = ml_models/operators/deeponet_model.pt

# Branch network (input function encoder)
num_sensors = 100
branch_layers = 100,128,128,64

# Trunk network (location encoder)
coord_dim = 3
trunk_layers = 3,128,128,64

# Number of basis functions
num_basis = 64

# Training
learning_rate = 1e-3
epochs = 200
batch_size = 256

# =============================================================================
# Usage Example
# =============================================================================
# For pressure solver:
#   ml_solver = FNO
#   fno_solver_method = HYBRID_FNO_REFINE
#
# For unstructured mesh:
#   ml_solver = GNO
#   gno_type = MESH_GRAPH_NET
#
# For fast parametric studies:
#   ml_solver = ROM
#   rom_type = POD_NN
# =============================================================================
