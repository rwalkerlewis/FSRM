# =============================================================================
# SCEC LOH.3: Layer Over Halfspace with Attenuation
# =============================================================================
# Reference: https://strike.scec.org/scecpedia/LOH.3
#
# Seismic wave propagation in a viscoelastic layer over elastic halfspace.
# Tests anelastic attenuation effects on wave propagation.
# =============================================================================

[SIMULATION]
name = scec_loh3
description = SCEC LOH.3 - Attenuating Layer
dimension = 3
physics = VISCOELASTIC_WAVE_PROPAGATION
time_integration = EXPLICIT

start_time = 0.0
end_time = 9.0
dt = 0.002
output_frequency = 50
output_dir = output/scec_loh3
output_format = HDF5

[GRID]
nx = 201
ny = 201
nz = 101
Lx = 30000.0
Ly = 30000.0
Lz = 17000.0
dx = 150.0
dy = 150.0
dz = 170.0

# Layered viscoelastic structure
[MATERIAL]
type = VISCOELASTIC_LAYERED

# Layer (0-1000m depth) - with attenuation
[LAYER1]
z_top = 0.0
z_bottom = 1000.0
density = 2600.0
vp = 4000.0
vs = 2000.0
Qp = 100.0
Qs = 50.0

# Halfspace (below 1000m) - elastic (high Q)
[LAYER2]
z_top = 1000.0
z_bottom = 17000.0
density = 2700.0
vp = 6000.0
vs = 3464.0
Qp = 1000.0
Qs = 500.0

[SOURCE]
type = POINT_EXPLOSION
location = 15000.0, 15000.0, 2000.0
moment = 1.0e18
source_time_function = GAUSSIAN
dominant_frequency = 1.0
duration = 0.5

[BC1]
type = FREE_SURFACE
location = ZMIN

[BC2]
type = ABSORBING
location = XMIN

[BC3]
type = ABSORBING
location = XMAX

[BC4]
type = ABSORBING
location = YMIN

[BC5]
type = ABSORBING
location = YMAX

[BC6]
type = ABSORBING
location = ZMAX

# Surface receivers in a line
[RECEIVER1]
type = BODY
location = 15000.0, 15000.0, 0.0
output_fields = velocity, displacement

[RECEIVER2]
type = BODY
location = 15000.0, 18000.0, 0.0
output_fields = velocity, displacement

[RECEIVER3]
type = BODY
location = 15000.0, 21000.0, 0.0
output_fields = velocity, displacement

[RECEIVER4]
type = BODY
location = 15000.0, 24000.0, 0.0
output_fields = velocity, displacement

[RECEIVER5]
type = BODY
location = 15000.0, 27000.0, 0.0
output_fields = velocity, displacement

# Radial receiver array
[RECEIVER6]
type = BODY
location = 18000.0, 18000.0, 0.0
output_fields = velocity, displacement

[RECEIVER7]
type = BODY
location = 21213.0, 21213.0, 0.0
output_fields = velocity, displacement

[SOLVER]
method = EXPLICIT
cfl = 0.5
