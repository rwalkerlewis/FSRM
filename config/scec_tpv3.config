# =============================================================================
# SCEC TPV3 Benchmark Configuration
# 2D In-Plane Strike-Slip Dynamic Rupture
# =============================================================================
#
# Reference: SCEC Code Verification Project
#            https://strike.scec.org/cvws/tpv3docs.html
#
# Domain: 2D plane strain, 60 km × 30 km (along-strike × across-fault)
# Fault: 30 km strike-slip fault at y = 0
# Nucleation: 3 km zone with overstressed patch
# Friction: Linear slip-weakening
#
# =============================================================================

[SIMULATION]
name = scec_tpv3
description = SCEC TPV3 - 2D In-Plane Strike-Slip Benchmark
dimension = 2
physics = ELASTODYNAMICS
solid_model = ELASTIC

# Time control
start_time = 0.0
end_time = 12.0
dt_initial = 0.001
dt_min = 1.0e-6
dt_max = 0.01
adaptive_timestepping = true

# CFL condition
cfl_number = 0.5

# Output
output_dir = output/scec_tpv3
output_format = HDF5
output_frequency = 100
checkpoint_frequency = 1000

[GRID]
# 2D domain
nx = 600
ny = 300
nz = 1

# Domain size (meters)
Lx = 60000.0
Ly = 30000.0
Lz = 1.0

# Grid spacing: 100 m
dx = 100.0
dy = 100.0

[ROCK]
# Material properties (homogeneous elastic)
density = 2670.0
p_wave_velocity = 6000.0
s_wave_velocity = 3464.0

# Derived elastic moduli
youngs_modulus = 32.04e9
poissons_ratio = 0.25
shear_modulus = 32.04e9
bulk_modulus = 32.04e9

[FAULT1]
name = main_fault
type = STRIKE_SLIP

# Geometry - fault along y = 0
x = 0.0
y = 0.0
z = 0.0
strike = 0.0
dip = 90.0
rake = 0.0
length = 30000.0
width = 1.0

# Friction law
friction_law = SLIP_WEAKENING
static_friction = 0.677
dynamic_friction = 0.525
slip_weakening_dc = 0.40
cohesion = 0.0

# Initial stress state (Pa)
# σ_yy = 120 MPa (normal stress)
# τ_xy = 70 MPa (shear stress)
initial_normal_stress = 120.0e6
initial_shear_stress = 70.0e6

# Nucleation zone
nucleation_type = FORCED
nucleation_center_x = 0.0
nucleation_center_y = 0.0
nucleation_size = 3000.0
nucleation_shear_stress = 81.6e6

[BC1]
# Absorbing boundaries
type = ABSORBING
location = XMIN
method = CLAYTON_ENGQUIST

[BC2]
type = ABSORBING
location = XMAX
method = CLAYTON_ENGQUIST

[BC3]
type = ABSORBING
location = YMIN
method = CLAYTON_ENGQUIST

[BC4]
type = ABSORBING
location = YMAX
method = CLAYTON_ENGQUIST

[IC1]
# Initial stress field
field = STRESS_XY
distribution = UNIFORM
value = 70.0e6

[IC2]
field = STRESS_YY
distribution = UNIFORM
value = -120.0e6

# Receivers for comparison
[RECEIVER1]
name = flt_st000dp000
location = 0.0, 0.0, 0.0
output_fields = slip_rate, slip, traction

[RECEIVER2]
name = flt_st030dp000
location = 3000.0, 0.0, 0.0
output_fields = slip_rate, slip, traction

[RECEIVER3]
name = flt_st075dp000
location = 7500.0, 0.0, 0.0
output_fields = slip_rate, slip, traction

[RECEIVER4]
name = flt_st120dp000
location = 12000.0, 0.0, 0.0
output_fields = slip_rate, slip, traction

[SOLVER]
method = EXPLICIT
time_integration = RUNGE_KUTTA_4
linear_solver = DIRECT
