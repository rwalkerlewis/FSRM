# Wave Propagation Example
# Elastic wave simulation with seismic source

[SIMULATION]
name = wave_propagation
start_time = 0.0
end_time = 2.0                  # 2 seconds
dt_initial = 0.001              # 1 ms
dt_min = 0.0001
dt_max = 0.005
output_frequency = 100
output_format = HDF5            # HDF5 (default), VTK (secondary)
fluid_model = SINGLE_COMPONENT
solid_model = ELASTIC
enable_geomechanics = true
enable_thermal = false
enable_fractures = false
enable_faults = false
enable_elastodynamics = true
rtol = 1.0e-8
atol = 1.0e-10
max_nonlinear_iterations = 20

[GRID]
nx = 100
ny = 100
nz = 50
Lx = 1000.0                     # 1 km
Ly = 1000.0
Lz = 500.0

[ROCK]
constitutive_model = LINEAR_ELASTIC
porosity = 0.15
density = 2400.0                # kg/mÂ³
youngs_modulus = 25.0e9         # 25 GPa
poisson_ratio = 0.25
# P-wave velocity ~4000 m/s, S-wave ~2300 m/s

[DYNAMICS]
enable = true
wave_type = ELASTIC
cfl_number = 0.5
absorbing_layers = 10
absorbing_strength = 100.0
source_type = RICKER
source_location = 500.0, 500.0, 100.0
source_time_function = RICKER
source_frequency = 25.0         # 25 Hz peak
source_amplitude = 1.0e6

[IC1]
field = DISPLACEMENT
distribution = UNIFORM
value = 0.0

[IC2]
field = VELOCITY
distribution = UNIFORM
value = 0.0

[BC1]
type = DIRICHLET
field = DISPLACEMENT
location = ZMAX
value = 0.0                     # Free surface

# Absorbing boundaries on sides
[BC2]
type = ABSORBING
field = DISPLACEMENT
location = XMIN
value = 0.0

[BC3]
type = ABSORBING
field = DISPLACEMENT
location = XMAX
value = 0.0

[BC4]
type = ABSORBING
field = DISPLACEMENT
location = YMIN
value = 0.0

[BC5]
type = ABSORBING
field = DISPLACEMENT
location = YMAX
value = 0.0

[BC6]
type = ABSORBING
field = DISPLACEMENT
location = ZMIN
value = 0.0

[OUTPUT]
format = VTK
path = output/wave_propagation
frequency = 50
pressure = false
displacement = true
velocity = true
stress = true
