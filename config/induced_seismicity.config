# Induced Seismicity Example
# Deep wastewater injection near critically stressed basement fault
# Black Oil + Poroelastic Coupling + Rate-State Friction

[SIMULATION]
name = induced_seismicity
start_time = 0.0
end_time = 63072000.0           # 2 years (seconds)
dt_initial = 86400.0            # 1 day
dt_min = 3600.0                 # 1 hour
dt_max = 604800.0               # 1 week
output_frequency = 100
output_format = HDF5            # HDF5 (default), VTK (secondary)
fluid_model = BLACK_OIL
solid_model = POROELASTIC
enable_geomechanics = true
enable_thermal = false
enable_fractures = false
enable_faults = true
rtol = 1.0e-6
atol = 1.0e-8
max_nonlinear_iterations = 100

[GRID]
nx = 80
ny = 1
nz = 48
Lx = 10000.0                    # 10 km
Ly = 100.0                      # 2D in XZ plane
Lz = 6000.0                     # 6 km depth

[ROCK]
constitutive_model = POROELASTIC
porosity = 0.02                 # Low porosity basement
permeability_x = 0.001          # 1 microdarcy (tight)
permeability_y = 0.001
permeability_z = 0.0001
density = 2800.0                # Crystalline basement
compressibility = 5.0e-11
youngs_modulus = 60.0e9         # 60 GPa
poisson_ratio = 0.25
biot_coefficient = 0.5

[FLUID]
type = BLACK_OIL
oil_density_std = 850.0
gas_density_std = 0.8
water_density_std = 1050.0
solution_gor = 50.0
bubble_point = 30.0e6
pvt_correlation = STANDING
oil_viscosity = 0.002           # 2 cP
water_viscosity = 0.0005        # 0.5 cP
gas_viscosity = 0.000015

[WELL1]
name = WASTE-INJ-1
type = INJECTOR
i = 24                          # 3 km from boundary
j = 0
k = 32                          # 4 km depth
control_mode = RATE
target_value = 0.00116          # 100 mÂ³/day
max_bhp = 55.0e6                # Near fracture pressure
fluid = WATER
diameter = 0.15

[WELL2]
name = MONITOR-FAULT
type = OBSERVATION
i = 36                          # Near fault
j = 0
k = 32
control_mode = RATE
target_value = 0.0

[WELL3]
name = MONITOR-FAR
type = OBSERVATION
i = 64                          # Far-field
j = 0
k = 32
control_mode = RATE
target_value = 0.0

[FAULT1]
name = BASEMENT_FAULT
x = 5000.0                      # Center of domain
y = 0.0
z = 4000.0                      # 4 km depth
strike = 0.0                    # N-S striking
dip = 60.0                      # 60 degree dip
length = 4000.0                 # 4 km along dip
width = 8000.0                  # 8 km along strike
friction_law = RATE_STATE_AGING
rate_state_a = 0.010
rate_state_b = 0.015            # b > a: unstable
rate_state_dc = 0.01            # 1 cm critical slip
rate_state_v0 = 1.0e-6
rate_state_f0 = 0.6
cohesion = 2.0e6                # 2 MPa

[SEISMICITY]
enable = true
friction_law = RATE_STATE_AGING
nucleation_size = 1.0
seismic_slip_rate = 1.0e-3
b_value = 1.0
aftershocks = true
stress_transfer = true
max_magnitude = 5.0
catalog_file = output/seismic_catalog.csv

[IC1]
field = PRESSURE
distribution = GRADIENT
value = 36.0e6                  # ~90% lithostatic at 4km
gradient = 0, 0, 9000           # Hydrostatic-ish gradient

[IC2]
field = TEMPERATURE
distribution = GRADIENT
value = 300.0                   # Surface temperature
gradient = 0, 0, 0.025          # 25 K/km

[BC1]
type = DIRICHLET
field = DISPLACEMENT
location = ZMAX
value = 0.0                     # Free surface

[BC2]
type = NEUMANN
field = PRESSURE
location = ALL
value = 0.0                     # No-flow

[OUTPUT]
format = VTK
path = output/induced_seismicity
frequency = 10
pressure = true
displacement = true
stress = true
fault_slip = true
seismic_catalog = true
