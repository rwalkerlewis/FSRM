# Induced Seismicity Configuration
# Wastewater injection with critically stressed fault

[SIMULATION]
start_time = 0.0
end_time = 63072000.0                 # 2 years
dt_initial = 3600.0                   # 1 hour
dt_min = 60.0                         # 1 minute (for fast events)
dt_max = 86400.0                      # 1 day
max_timesteps = 20000

output_frequency = 100                # More frequent output
output_format = HDF5                  # Better for large datasets
enable_checkpointing = true
checkpoint_frequency = 200

rtol = 1.0e-7                         # Tight tolerance for coupled problem
atol = 1.0e-9
max_nonlinear_iterations = 100
max_linear_iterations = 5000

fluid_model = SINGLE_COMPONENT
solid_model = POROELASTIC             # Coupled fluid-solid

enable_geomechanics = true
enable_thermal = false
enable_fractures = false
enable_particle_transport = false
enable_faults = true                  # Critical feature
enable_tidal_forces = true            # Can trigger events
adaptive_timestepping = true

[GRID]
nx = 80
ny = 80
nz = 40

# Large domain to capture far-field effects: 8 km x 8 km x 4 km
Lx = 8000.0
Ly = 8000.0
Lz = 4000.0

use_unstructured = false

[ROCK]
# Crystalline basement rock properties
porosity = 0.02                       # Low porosity (2%)
permeability_x = 0.01                 # 10 nanoDarcy
permeability_y = 0.01
permeability_z = 0.005                # Anisotropic

compressibility = 2.0e-10             # Very stiff

# Mechanical properties - basement rock
youngs_modulus = 40.0e9               # 40 GPa
poisson_ratio = 0.25
density = 2700.0                      # kg/m³
biot_coefficient = 0.6                # Poroelastic coupling

# No significant viscoelasticity
relaxation_time = 1.0e10
viscosity = 1.0e25

# Thermal properties (not main focus but included)
thermal_conductivity = 2.8            # W/(m·K)
heat_capacity = 850.0                 # J/(kg·K)
thermal_expansion = 1.0e-5            # 1/K

# Fault/fracture properties
fracture_toughness = 1.5e6            # Pa·m^0.5
fracture_energy = 100.0               # J/m²

[FLUID]
# Wastewater (similar to brine)
density = 1050.0                      # kg/m³ (dense brine)
viscosity = 0.0012                    # Pa·s (1.2 cP)
compressibility = 4.5e-10             # 1/Pa

# Single component - just track pressure
oil_density_std = 1050.0
gas_density_std = 0.0
water_density_std = 1050.0

oil_viscosity = 0.0012
gas_viscosity = 0.00001
water_viscosity = 0.0012

solution_GOR = 0.0

[WELL1]
# Deep injection well
name = INJ_DEEP
type = INJECTOR
i = 40
j = 40
k = 30                                # Deep injection
control_mode = RATE
target_value = 0.1                    # 100 L/s
max_rate = 0.2
min_bhp = 80.0e6                      # 80 MPa max pressure
diameter = 0.2
skin = 0.0

[WELL2]
# Observation well near fault
name = OBS_NEAR
type = OBSERVATION
i = 50
j = 50
k = 25
control_mode = BHP
target_value = 0.0
max_rate = 0.0
min_bhp = 0.0
diameter = 0.15
skin = 0.0

[WELL3]
# Observation well far field
name = OBS_FAR
type = OBSERVATION
i = 70
j = 70
k = 25
control_mode = BHP
target_value = 0.0
max_rate = 0.0
min_bhp = 0.0
diameter = 0.15
skin = 0.0

[FAULT1]
# Critically stressed strike-slip fault
name = SEISMOGENIC_FAULT
strike = 1.0, 0.0, 0.0                # E-W strike
dip = 0.0, 0.0, 1.0                   # Vertical (strike-slip)
length = 5000.0                       # 5 km long
width = 3000.0                        # 3 km depth extent
static_friction = 0.6                 # Byerlee friction
dynamic_friction = 0.4
cohesion = 1.0e6                      # 1 MPa
use_rate_state = true                 # Critical for seismicity
a_parameter = 0.010                   # Velocity dependence
b_parameter = 0.015                   # State dependence (b>a = unstable)
Dc_parameter = 0.001                  # 1 mm critical slip

[BC1]
# Far-field pressure
type = DIRICHLET
field = PRESSURE
location = XMIN
value = 40.0e6                        # 40 MPa

[BC2]
type = DIRICHLET
field = PRESSURE
location = XMAX
value = 40.0e6

[BC3]
type = DIRICHLET
field = PRESSURE
location = YMIN
value = 40.0e6

[BC4]
type = DIRICHLET
field = PRESSURE
location = YMAX
value = 40.0e6

[BC5]
# Far-field stress (tectonic)
type = NEUMANN
field = DISPLACEMENT
location = XMIN
value = 0.0
gradient = 60.0e6                     # Compressive stress

[BC6]
type = NEUMANN
field = DISPLACEMENT
location = XMAX
value = 0.0
gradient = -60.0e6

[IC1]
# Initial pressure (hydrostatic at 3 km depth)
field = PRESSURE
distribution = GRADIENT
value = 30.0e6                        # 30 MPa at top
gradient = 0.0, 0.0, 10000.0          # Hydrostatic gradient

[IC2]
# Initial stress state
field = DISPLACEMENT
distribution = UNIFORM
value = 0.0
