# Split Node Fault Modeling Example Configuration
# Demonstrates fault modeling using split (duplicated) nodes with
# traction boundary conditions for realistic fault behavior
#
# Split nodes allow discontinuous displacement across fault surfaces,
# enabling proper modeling of slip, stick-slip behavior, and seismicity.

[SIMULATION]
name = split_node_fault_example
start_time = 0.0
end_time = 31536000.0           # 1 year (seconds)
dt_initial = 86400.0            # 1 day
dt_min = 3600.0                 # 1 hour
dt_max = 604800.0               # 1 week
fluid_model = SINGLE_COMPONENT
solid_model = POROELASTIC
enable_geomechanics = true
enable_thermal = false
enable_fractures = false
enable_faults = true
rtol = 1.0e-6
atol = 1.0e-8
max_nonlinear_iterations = 100

[GRID]
nx = 60
ny = 1
nz = 40
Lx = 6000.0                     # 6 km
Ly = 100.0                      # 2D in XZ plane
Lz = 4000.0                     # 4 km depth

[ROCK]
constitutive_model = POROELASTIC
porosity = 0.05
permeability_x = 0.01           # 10 millidarcy
permeability_y = 0.01
permeability_z = 0.001
density = 2700.0
compressibility = 1.0e-10
youngs_modulus = 40.0e9         # 40 GPa
poisson_ratio = 0.25
biot_coefficient = 0.7

[FLUID]
type = WATER
density = 1000.0
viscosity = 0.001
compressibility = 4.5e-10

#==============================================================================
# SPLIT NODE FAULT EXAMPLE 1: Friction-Dependent Traction (Default Behavior)
# 
# This fault uses split nodes with penalty method enforcement.
# Traction is computed from Coulomb friction based on the slip state.
#==============================================================================
[FAULT1]
name = MAIN_FAULT_FRICTION
x = 3000.0                      # Center of domain
y = 0.0
z = 2000.0                      # 2 km depth
strike = 0.0                    # N-S striking fault
dip = 70.0                      # 70 degree dip
length = 2000.0                 # 2 km along dip
width = 4000.0                  # 4 km along strike

# Enable split node modeling
use_split_nodes = true
split_node_method = PENALTY     # Options: PENALTY, LAGRANGE, NITSCHE, MORTAR, AUGMENTED_LAGRANGIAN
traction_type = FRICTION_DEPENDENT

# Penalty stiffness parameters
penalty_normal = 1.0e12         # Normal contact stiffness (Pa/m)
penalty_tangent = 1.0e10        # Tangential stiffness (Pa/m)

# Friction parameters
friction_law = COULOMB
static_friction = 0.6
dynamic_friction = 0.4
cohesion = 2.0e6                # 2 MPa cohesion
slip_weakening_dc = 0.01        # 1 cm critical slip distance

# Contact behavior
allow_separation = true         # Allow tensile opening
contact_tolerance = 1.0e-10     # Gap tolerance (m)

#==============================================================================
# SPLIT NODE FAULT EXAMPLE 2: Prescribed Traction
# 
# This fault has user-specified constant traction values.
# Useful for studying fault response under known stress conditions.
#==============================================================================
[FAULT2]
name = SECONDARY_FAULT_PRESCRIBED
x = 4500.0
y = 0.0
z = 1500.0
strike = 45.0                   # NE-SW striking
dip = 60.0
length = 1000.0
width = 2000.0

use_split_nodes = true
split_node_method = PENALTY
traction_type = PRESCRIBED

# Prescribed traction values (Pa)
prescribed_traction_normal = -30.0e6    # 30 MPa normal compression
prescribed_traction_strike = 15.0e6     # 15 MPa right-lateral shear
prescribed_traction_dip = 0.0           # No dip-slip traction

# Friction still applies as a limit
friction_law = COULOMB
static_friction = 0.6
dynamic_friction = 0.4
cohesion = 1.0e6

#==============================================================================
# SPLIT NODE FAULT EXAMPLE 3: Cohesive Zone Model
# 
# This fault uses a cohesive zone traction-separation law.
# Good for modeling fault healing, damage, and progressive failure.
#==============================================================================
[FAULT3]
name = COHESIVE_FAULT
x = 1500.0
y = 0.0
z = 2500.0
strike = 315.0                  # NW-SE striking
dip = 80.0
length = 800.0
width = 1500.0

use_split_nodes = true
split_node_method = NITSCHE     # Nitsche's method for consistent penalty
traction_type = COHESIVE_ZONE

# Nitsche stabilization
nitsche_gamma = 100.0           # Stabilization parameter

# Cohesive zone parameters
cohesive_strength = 5.0e6       # Peak cohesive traction (Pa)
critical_opening = 1.0e-4       # Critical normal opening (m) - 0.1 mm
critical_slip = 1.0e-3          # Critical slip distance (m) - 1 mm

# After cohesion is lost, friction governs
friction_law = SLIP_WEAKENING
static_friction = 0.65
dynamic_friction = 0.35
cohesion = 0.5e6

#==============================================================================
# SPLIT NODE FAULT EXAMPLE 4: Rate-State Friction with Split Nodes
# 
# Advanced fault model using rate-and-state friction with split nodes.
# Captures stick-slip dynamics and earthquake nucleation.
#==============================================================================
[FAULT4]
name = RATE_STATE_FAULT
x = 2200.0
y = 0.0
z = 3000.0
strike = 0.0
dip = 60.0
length = 1500.0
width = 3000.0

use_split_nodes = true
split_node_method = AUGMENTED_LAGRANGIAN  # More robust for rate-state
traction_type = RATE_STATE

# Augmented Lagrangian parameters
augmented_lagrangian_r = 1.0e10
augmented_lagrangian_max_iter = 10
augmented_lagrangian_tol = 1.0e-8

# Rate-state friction law
friction_law = RATE_STATE_AGING
rate_state_a = 0.010            # Direct effect parameter
rate_state_b = 0.015            # Evolution effect parameter (b > a: unstable)
rate_state_dc = 0.01            # State evolution distance (m)
rate_state_v0 = 1.0e-6          # Reference velocity (m/s)
rate_state_f0 = 0.6             # Reference friction coefficient
rate_state_theta0 = 1.0e6       # Initial state variable (s)

# Additional physics
enable_cohesion = true
enable_dilation = false
cohesion = 1.5e6

[WELL1]
name = INJECTION_WELL
type = INJECTOR
i = 20                          # Near fault zone
j = 0
k = 25
control_mode = RATE
target_value = 0.001            # ~86 mÂ³/day
max_bhp = 45.0e6
fluid = WATER
diameter = 0.15

[IC1]
field = PRESSURE
distribution = GRADIENT
value = 25.0e6                  # Hydrostatic at surface
gradient = 0, 0, 10000          # ~10 MPa/km

[BC1]
type = DIRICHLET
field = DISPLACEMENT
location = ZMAX
value = 0.0                     # Free surface

[BC2]
type = NEUMANN
field = PRESSURE
location = ALL
value = 0.0                     # No-flow boundaries

# Stress state (for geomechanics)
[STRESS]
sigma_h_min = 25.0e6            # Minimum horizontal stress
sigma_h_max = 40.0e6            # Maximum horizontal stress  
sigma_v_gradient = 25000        # Vertical stress gradient (Pa/m)
orientation = 60.0              # SHmax orientation from North

[OUTPUT]
format = VTK
path = output/split_node_fault
frequency = 10
pressure = true
displacement = true
stress = true
fault_slip = true
fault_traction = true
seismic_catalog = true

[SEISMICITY]
enable = true
nucleation_size = 1.0
seismic_slip_rate = 1.0e-3
b_value = 1.0
catalog_file = output/split_node_catalog.csv
