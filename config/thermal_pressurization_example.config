# ============================================================================
# Dynamic Rupture with Thermal Pressurization
# ============================================================================
# NEW FEATURE: Thermal pressurization of pore fluids during earthquake slip
# This dramatically weakens faults and explains low apparent friction
# ============================================================================

[SIMULATION]
start_time = 0.0
end_time = 20.0                    # seconds
dt_initial = 0.0001                # Small timestep for TP diffusion
dt_min = 1e-6
dt_max = 0.001
output_frequency = 100
output_directory = output/thermal_press

# Use DG + ADER + LTS for efficiency
use_discontinuous_galerkin = true
dg_order = 4
use_ader_time_integration = true
enable_local_time_stepping = true
lts_rate = 2

# Physics
enable_elastodynamics = true
enable_dynamic_rupture = true
enable_poroelasticity = false      # Can couple later!

# GPU
use_gpu = true

[GRID]
nx = 300
ny = 1
nz = 150
Lx = 60000.0                       # 60 km
Ly = 100.0
Lz = 30000.0                       # 30 km

[ROCK]
youngs_modulus = 30e9
poisson_ratio = 0.25
density = 2700.0
p_wave_velocity = 6000.0
s_wave_velocity = 3464.0

# Attenuation
enable_attenuation = true
attenuation_num_mechanisms = 3
quality_factor_p = 75.0
quality_factor_s = 35.0

[FAULT1]
type = PLANAR_VERTICAL
strike = 0.0                       # N-S fault
dip = 90.0
x_center = 0.0
z_center = -15000.0
length = 60000.0
width = 30000.0

# Rate-and-state friction with thermal pressurization
friction_law = RATE_STATE_AGING_WITH_TP
rs_a = 0.008                       # Direct effect
rs_b = 0.012                       # Evolution effect (velocity weakening)
rs_L = 0.02                        # State evolution distance [m]
rs_f0 = 0.6                        # Reference friction
rs_V0 = 1.0e-6                     # Reference velocity [m/s]

# NEW: Thermal pressurization parameters
enable_thermal_pressurization = true
tp_thermal_diffusivity = 1.0e-6    # m²/s (rock)
tp_hydraulic_diffusivity = 1.0e-4  # m²/s
tp_specific_heat = 2.7e6           # J/(m³·K)
tp_Lambda = 0.1e6                  # Pa/K (undrained TP response)
tp_half_width_shear_zone = 0.01    # m (1 cm gouge)
tp_initial_temperature = 483.15    # K (210°C at depth)
tp_initial_pore_pressure = -30e6   # Pa (negative = compression)

# Initial stress
initial_shear_stress = 60.0e6      # Pa
initial_normal_stress = -100.0e6   # Pa

# Nucleation
nucleation_type = SPATIAL_PATCH
nucleation_x_center = 0.0
nucleation_z_center = -15000.0
nucleation_radius = 2000.0
nucleation_shear_stress = 75.0e6   # Higher in nucleation zone

[OUTPUT]
output_fault_data = true
fault_output_fields = slip,slip_rate,shear_stress,normal_stress,rupture_time,pore_pressure,temperature
fault_output_frequency = 10

# NEW: Temperature and pressure evolution
output_tp_evolution = true
tp_output_frequency = 10

volume_output_fields = velocity,displacement,stress
volume_output_frequency = 100

[ANALYSIS]
# Analyze effective friction reduction
compute_apparent_friction = true
compute_fracture_energy = true
compute_stress_drop = true
