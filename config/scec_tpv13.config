# =============================================================================
# SCEC TPV13 Benchmark Configuration
# 60-Degree Dipping Normal Fault with Rate-State Friction
# =============================================================================
#
# Reference: SCEC Code Verification Project
#            https://strike.scec.org/cvws/tpv12_13docs.html
#
# Same geometry as TPV12 but with rate-state friction
#
# =============================================================================

[SIMULATION]
name = scec_tpv13
description = SCEC TPV13 - 60Â° Dipping Normal Fault (Rate-State)
dimension = 3
physics = ELASTODYNAMICS
solid_model = ELASTIC

# Time control
start_time = 0.0
end_time = 12.0
dt_initial = 0.0005
dt_min = 1.0e-7
dt_max = 0.005
adaptive_timestepping = true
cfl_number = 0.4

# Output
output_dir = output/scec_tpv13
output_format = HDF5
output_frequency = 200

[GRID]
nx = 300
ny = 300
nz = 150
Lx = 60000.0
Ly = 60000.0
Lz = 30000.0

[ROCK]
density = 2670.0
p_wave_velocity = 6000.0
s_wave_velocity = 3464.0
shear_modulus = 32.04e9

[FAULT1]
name = normal_fault
type = NORMAL

x = 30000.0
y = 30000.0
z = -7500.0
strike = 0.0
dip = 60.0
rake = -90.0
length = 30000.0
width = 15000.0

# Rate-state friction
friction_law = RATE_STATE_AGING
rate_state_a = 0.010
rate_state_b = 0.014
rate_state_dc = 0.10
rate_state_v0 = 1.0e-6
rate_state_f0 = 0.6

initial_sigma_xx = -60.0e6
initial_sigma_yy = -60.0e6
initial_sigma_zz = -120.0e6

nucleation_type = VELOCITY_PERTURBATION
nucleation_center_x = 30000.0
nucleation_center_z = -10000.0
nucleation_size = 3000.0
nucleation_velocity = 1.0

[BC1]
type = FREE_SURFACE
location = ZMAX

[BC2]
type = ABSORBING
location = XMIN
method = PML
pml_thickness = 3000.0

[BC3]
type = ABSORBING
location = XMAX
method = PML
pml_thickness = 3000.0

[BC4]
type = ABSORBING
location = YMIN
method = PML
pml_thickness = 3000.0

[BC5]
type = ABSORBING
location = YMAX
method = PML
pml_thickness = 3000.0

[BC6]
type = ABSORBING
location = ZMIN
method = PML
pml_thickness = 3000.0

[SOLVER]
method = EXPLICIT
time_integration = ADER_DG
polynomial_order = 4
