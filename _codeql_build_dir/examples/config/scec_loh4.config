# =============================================================================
# SCEC LOH.4: Layer Over Halfspace - Multiple Layers
# =============================================================================
# Reference: https://strike.scec.org/scecpedia/LOH.4
#
# Seismic wave propagation through multiple crustal layers.
# Tests wave propagation in realistic layered earth model.
# =============================================================================

[SIMULATION]
name = scec_loh4
description = SCEC LOH.4 - Multiple Layers
dimension = 3
physics = ELASTODYNAMICS
time_integration = EXPLICIT

start_time = 0.0
end_time = 12.0
dt = 0.002
output_frequency = 50
output_dir = output/scec_loh4
output_format = HDF5

[GRID]
nx = 201
ny = 201
nz = 151
Lx = 30000.0
Ly = 30000.0
Lz = 25000.0
dx = 150.0
dy = 150.0
dz = 166.67

# Multiple layers
[MATERIAL]
type = LAYERED

# Layer 1: Surface sediments (0-500m)
[LAYER1]
z_top = 0.0
z_bottom = 500.0
density = 2200.0
vp = 2400.0
vs = 1200.0

# Layer 2: Upper crust (500-2000m)
[LAYER2]
z_top = 500.0
z_bottom = 2000.0
density = 2400.0
vp = 3600.0
vs = 1800.0

# Layer 3: Middle crust (2000-5000m)
[LAYER3]
z_top = 2000.0
z_bottom = 5000.0
density = 2600.0
vp = 5000.0
vs = 2700.0

# Layer 4: Lower crust (5000-10000m)
[LAYER4]
z_top = 5000.0
z_bottom = 10000.0
density = 2700.0
vp = 6000.0
vs = 3400.0

# Halfspace: Upper mantle (below 10000m)
[LAYER5]
z_top = 10000.0
z_bottom = 25000.0
density = 3200.0
vp = 8000.0
vs = 4500.0

[SOURCE]
type = DOUBLE_COUPLE
location = 15000.0, 15000.0, 4000.0
strike = 0.0
dip = 90.0
rake = 0.0
moment = 1.0e18
source_time_function = GAUSSIAN
dominant_frequency = 0.5
duration = 1.0

[BC1]
type = FREE_SURFACE
location = ZMIN

[BC2]
type = ABSORBING
location = XMIN

[BC3]
type = ABSORBING
location = XMAX

[BC4]
type = ABSORBING
location = YMIN

[BC5]
type = ABSORBING
location = YMAX

[BC6]
type = ABSORBING
location = ZMAX

# Surface receivers
[RECEIVER1]
type = BODY
location = 15000.0, 15000.0, 0.0
output_fields = velocity, displacement

[RECEIVER2]
type = BODY
location = 15000.0, 18000.0, 0.0
output_fields = velocity, displacement

[RECEIVER3]
type = BODY
location = 15000.0, 21000.0, 0.0
output_fields = velocity, displacement

[RECEIVER4]
type = BODY
location = 15000.0, 24000.0, 0.0
output_fields = velocity, displacement

[RECEIVER5]
type = BODY
location = 18000.0, 18000.0, 0.0
output_fields = velocity, displacement

[RECEIVER6]
type = BODY
location = 21000.0, 21000.0, 0.0
output_fields = velocity, displacement

# Borehole receiver
[RECEIVER7]
type = BODY
location = 15000.0, 15000.0, 3000.0
output_fields = velocity, displacement

[RECEIVER8]
type = BODY
location = 15000.0, 15000.0, 6000.0
output_fields = velocity, displacement

[SOLVER]
method = EXPLICIT
cfl = 0.5
