# =============================================================================
# SPE5 Benchmark Configuration
# Miscible CO2 Flooding Problem
# =============================================================================
#
# Reference: Killough, J.E. and Kossack, C.A., SPE 16000 (1987)
#
# Tests compositional simulation with:
# - CO2 injection and miscibility development
# - 6-component hydrocarbon system
# - First-contact and multiple-contact miscibility
#
# Grid: 7x7x3 = 147 cells
# Duration: 2000 days
#
# =============================================================================

[SIMULATION]
name = spe5_miscible
description = SPE5 - Miscible CO2 Flooding
physics = COMPOSITIONAL
fluid_model = COMPOSITIONAL

start_time = 0.0
end_time = 2000.0
dt_initial = 1.0
dt_max = 30.0
time_unit = days

output_dir = output/spe5
output_format = HDF5
output_frequency = 20

[GRID]
nx = 7
ny = 7
nz = 3
Lx = 3048.0
Ly = 3048.0
Lz = 30.48
# Cell dimensions: 435.43 x 435.43 x 10.16 m

[ROCK]
porosity = 0.08
permeability_x = 500.0
permeability_y = 500.0
permeability_z = 50.0
compressibility = 4.35e-10

[EOS]
type = PENG_ROBINSON
number_components = 6

[COMPONENT1]
name = CO2
molecular_weight = 44.01
critical_temperature = 304.2
critical_pressure = 7.38e6
acentric_factor = 0.225

[COMPONENT2]
name = C1
molecular_weight = 16.04
critical_temperature = 190.6
critical_pressure = 4.60e6
acentric_factor = 0.013

[COMPONENT3]
name = C3
molecular_weight = 44.10
critical_temperature = 369.8
critical_pressure = 4.25e6
acentric_factor = 0.152

[COMPONENT4]
name = C6
molecular_weight = 86.18
critical_temperature = 507.4
critical_pressure = 3.01e6
acentric_factor = 0.296

[COMPONENT5]
name = C10
molecular_weight = 142.29
critical_temperature = 617.6
critical_pressure = 2.10e6
acentric_factor = 0.490

[COMPONENT6]
name = C15
molecular_weight = 212.42
critical_temperature = 705.0
critical_pressure = 1.52e6
acentric_factor = 0.685

[BIP]
CO2-C1 = 0.12
CO2-C3 = 0.12
CO2-C6 = 0.12
CO2-C10 = 0.10
CO2-C15 = 0.10

[IC_COMPOSITION]
CO2 = 0.00
C1 = 0.50
C3 = 0.03
C6 = 0.07
C10 = 0.20
C15 = 0.20

[IC1]
field = PRESSURE
distribution = GRADIENT
value = 23.0e6
gradient = 0, 0, 9800

[IC2]
field = TEMPERATURE
distribution = UNIFORM
value = 344.0

[WELL1]
name = CO2_INJECTOR
type = INJECTOR
i = 1
j = 1
k = 1, 2, 3
control_mode = RATE
target_value = 0.05
injection_fluid = GAS
injection_composition = 1.0, 0.0, 0.0, 0.0, 0.0, 0.0

[WELL2]
name = PRODUCER
type = PRODUCER
i = 7
j = 7
k = 1, 2, 3
control_mode = BHP
target_value = 10.0e6

[SOLVER]
method = IMPLICIT
newton_max_iterations = 20
newton_tolerance = 1.0e-6
flash_max_iterations = 50
