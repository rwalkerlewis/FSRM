# ============================================================================
# Wave Propagation in Anisotropic Layered Basin
# ============================================================================
# NEW FEATURE: Full anisotropic elasticity (21 elastic constants)
# Models realistic sedimentary basins with layered anisotropy
# ============================================================================

[SIMULATION]
start_time = 0.0
end_time = 30.0                    # seconds
dt_initial = 0.001
output_frequency = 100
output_directory = output/anisotropic_basin

# DG method
use_discontinuous_galerkin = true
dg_order = 5                       # Higher order for accurate wave propagation
use_ader_time_integration = true
enable_local_time_stepping = true

enable_elastodynamics = true
use_gpu = true

[GRID]
use_unstructured = true
mesh_file = meshes/layered_basin.msh

[ROCK1]
# Basement: Isotropic granite
name = basement
youngs_modulus = 60e9
poisson_ratio = 0.22
density = 2700.0
p_wave_velocity = 6200.0
s_wave_velocity = 3600.0

# Attenuation
quality_factor_p = 150.0
quality_factor_s = 75.0

[ROCK2]
# Sediment layer 1: Transversely isotropic (vertical symmetry axis)
name = sediment_deep
enable_anisotropy = true
anisotropy_type = TRANSVERSE_ISOTROPIC

# TI parameters
E_parallel = 40e9                  # Parallel to bedding
E_perpendicular = 25e9             # Perpendicular to bedding
nu_parallel = 0.25
nu_perpendicular = 0.30
G_perpendicular = 8e9
density = 2400.0

# Symmetry axis orientation (bedding normal)
symmetry_axis_strike = 0.0         # degrees
symmetry_axis_dip = 0.0            # horizontal bedding

# Lower Q in sediments
quality_factor_p = 40.0
quality_factor_s = 20.0

[ROCK3]
# Sediment layer 2: Stronger anisotropy
name = sediment_shallow
enable_anisotropy = true
anisotropy_type = TRANSVERSE_ISOTROPIC

E_parallel = 30e9
E_perpendicular = 15e9             # Strong anisotropy
nu_parallel = 0.28
nu_perpendicular = 0.35
G_perpendicular = 5e9
density = 2200.0

symmetry_axis_dip = 0.0

# Very low Q near surface
quality_factor_p = 25.0
quality_factor_s = 12.0

[ROCK4]
# Shale layer: Orthotropic (fractured)
name = shale_fractured
enable_anisotropy = true
anisotropy_type = ORTHOTROPIC

# Three principal directions
E1 = 35e9                          # Along bedding strike
E2 = 30e9                          # Along bedding dip
E3 = 20e9                          # Perpendicular to bedding
nu12 = 0.26
nu23 = 0.30
nu31 = 0.28
G12 = 11e9
G23 = 9e9
G31 = 10e9
density = 2450.0

# Principal directions (aligned with fractures)
dir1_strike = 45.0                 # Fracture set 1
dir2_strike = 135.0                # Fracture set 2 (orthogonal)
dir3_dip = 0.0                     # Bedding normal

quality_factor_p = 30.0
quality_factor_s = 15.0

[SOURCE1]
# Point source (earthquake)
type = POINT_SOURCE
x = 0.0
y = 0.0
z = -10000.0                       # 10 km depth in basement
magnitude = 5.5
mechanism = DOUBLE_COUPLE
strike = 180.0
dip = 45.0
rake = 90.0
source_time_function = GAUSSIAN
source_duration = 1.0

[BC1]
type = FREE_SURFACE
location = ZMAX

[BC2]
type = ABSORBING
location = XMIN,XMAX,YMIN,YMAX,ZMIN

[OUTPUT]
volume_output_fields = velocity,displacement,strain,stress
volume_output_frequency = 50

# Wave analysis
enable_waveform_analysis = true
analyze_phase_velocity = true
analyze_group_velocity = true
compute_polarization = true

# Receivers at surface
enable_receivers = true
receiver_array_type = GRID
receiver_grid_nx = 50
receiver_grid_ny = 50
receiver_grid_z = 0.0              # Surface

[ANALYSIS]
# Analyze anisotropic wave propagation
compute_dispersion_curves = true
analyze_shear_wave_splitting = true
measure_azimuthal_variation = true
