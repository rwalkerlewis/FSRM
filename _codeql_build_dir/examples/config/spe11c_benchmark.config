# =============================================================================
# SPE11 Case C Benchmark Configuration
# CO2 Geological Storage - Full 3D Model
# =============================================================================
#
# Reference: Nordbotten, J.M. et al., SPE Journal (2024)
#            https://spe11-group.github.io/
#
# Case C: Full 3D model for comprehensive testing
# Domain: 8.4 km × 5 km × 1.2 km
# Duration: 1000 years
#
# WARNING: This is a large-scale simulation requiring significant
# computational resources. Recommend >= 32 MPI processes.
#
# =============================================================================

[SIMULATION]
name = spe11c_co2_storage
description = SPE11 Case C - Full 3D CO2 Storage Model
dimension = 3
physics = TWO_PHASE_FLOW
fluid_model = CO2_BRINE

start_time = 0.0
end_time = 31536000000.0
dt_initial = 86400.0
dt_min = 3600.0
dt_max = 15768000.0
time_unit = seconds
adaptive_timestepping = true

injection_end_time = 1576800000.0

output_dir = output/spe11c
output_format = HDF5
output_frequency = 25

# Reporting times (years)
report_times = 157680000, 315360000, 788400000, 1576800000, 3153600000, 6307200000, 15768000000, 31536000000

[GRID]
# 3D domain: 8400 m × 5000 m × 1200 m
nx = 168
ny = 100
nz = 24

Lx = 8400.0
Ly = 5000.0
Lz = 1200.0

# Grid spacing: 50 m × 50 m × 50 m (coarser than 2D for tractability)
dx = 50.0
dy = 50.0
dz = 50.0

[ROCK]
permeability_type = FACIES_BASED
num_facies = 7

[FACIES1]
name = reservoir_sand
porosity = 0.25
permeability_x = 2.0e-13
permeability_y = 2.0e-13
permeability_z = 2.0e-14

[FACIES2]
name = channel_sand
porosity = 0.30
permeability_x = 5.0e-12
permeability_y = 5.0e-12
permeability_z = 5.0e-13

[FACIES3]
name = shale
porosity = 0.10
permeability_x = 1.0e-19
permeability_y = 1.0e-19
permeability_z = 1.0e-20

[FACIES4]
name = seal
porosity = 0.05
permeability_x = 1.0e-21
permeability_y = 1.0e-21
permeability_z = 1.0e-22

[FACIES5]
name = transition
porosity = 0.20
permeability_x = 1.0e-14
permeability_y = 1.0e-14
permeability_z = 1.0e-15

[FACIES6]
name = boundary
porosity = 0.01
permeability = 0.0
inactive = true

[FACIES7]
name = wellbore
porosity = 0.30
permeability = 1.0e-11

# Load 3D facies distribution
# facies_file = data/spe11c_facies.dat

[CO2_PROPERTIES]
eos_model = SPAN_WAGNER
enable_dissolution = true
dissolution_model = DUAN_SUN
diffusion_coefficient = 2.0e-9

[BRINE_PROPERTIES]
salinity = 0.1
reference_density = 1045.0
reference_viscosity = 0.0005
compressibility = 4.5e-10

[RELATIVE_PERMEABILITY]
model = BROOKS_COREY
swc = 0.32
sgr = 0.10
krw_max = 0.60
krg_max = 0.40
nw = 4.0
ng = 2.0
enable_hysteresis = true
hysteresis_model = CARLSON
land_parameter = 1.5

[CAPILLARY_PRESSURE]
model = VAN_GENUCHTEN
entry_pressure = 3000.0
lambda = 0.8
max_pc = 1.0e6

[IC1]
field = PRESSURE
distribution = GRADIENT
reference_value = 13.0e6
reference_depth = 1000.0
gradient = 0, 0, -10000

[IC2]
field = SATURATION_WATER
distribution = UNIFORM
value = 1.0

[IC3]
field = TEMPERATURE
distribution = GRADIENT
reference_value = 323.15
reference_depth = 1000.0
gradient = 0, 0, -0.03

# Two injection wells for 3D case
[WELL1]
name = CO2_INJECTOR_1
type = INJECTOR
well_type = VERTICAL
x = 2700.0
y = 2500.0
z_top = 300.0
z_bottom = 350.0
control_mode = RATE
target_value = 0.0075
injection_fluid = CO2
max_bhp = 30.0e6

[WELL2]
name = CO2_INJECTOR_2
type = INJECTOR
well_type = VERTICAL
x = 5700.0
y = 2500.0
z_top = 300.0
z_bottom = 350.0
control_mode = RATE
target_value = 0.0075
injection_fluid = CO2
max_bhp = 30.0e6

[BC1]
type = NO_FLOW
location = ZMAX

[BC2]
type = NO_FLOW
location = ZMIN

[BC3]
type = NO_FLOW
location = XMIN

[BC4]
type = DIRICHLET
location = XMAX
field = PRESSURE
value = 10.0e6

[BC5]
type = NO_FLOW
location = YMIN

[BC6]
type = NO_FLOW
location = YMAX

# Multiple monitoring points
[MONITOR1]
name = obs_A
location = 4200.0, 2500.0, 700.0
output_fields = pressure, saturation_co2, dissolved_co2

[MONITOR2]
name = obs_B
location = 4200.0, 2500.0, 1000.0
output_fields = pressure, saturation_co2, dissolved_co2

[MONITOR3]
name = obs_C
location = 5500.0, 1000.0, 800.0
output_fields = pressure, saturation_co2, dissolved_co2

[MONITOR4]
name = obs_D
location = 5500.0, 4000.0, 800.0
output_fields = pressure, saturation_co2, dissolved_co2

[OUTPUT_FIELDS]
pressure = true
saturation_co2 = true
saturation_brine = true
dissolved_co2 = true
mobile_co2 = true
immobile_co2 = true
co2_mass_total = true
co2_mass_dissolved = true
co2_mass_mobile = true
co2_mass_immobile = true
temperature = true

[SOLVER]
method = IMPLICIT
newton_max_iterations = 30
newton_tolerance = 1.0e-6
linear_solver = GMRES
preconditioner = HYPRE_BOOMERAMG
max_timestep_cuts = 15

# Parallel settings
[PARALLEL]
partition_method = PARMETIS
load_balance_frequency = 100
