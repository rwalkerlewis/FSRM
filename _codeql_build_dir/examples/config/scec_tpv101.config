# =============================================================================
# SCEC TPV101 Benchmark Configuration
# Viscoelastic Off-Fault Plasticity
# =============================================================================
#
# Reference: SCEC Code Verification Project
#            https://strike.scec.org/cvws/tpv101docs.html
#
# Domain: 3D viscoelastic half-space with Drucker-Prager plasticity
# Fault: Vertical strike-slip fault
# Tests: Off-fault plastic yielding, energy dissipation, Q attenuation
#
# =============================================================================

[SIMULATION]
name = scec_tpv101
description = SCEC TPV101 - Viscoelastic Off-Fault Plasticity
dimension = 3
physics = ELASTODYNAMICS
solid_model = VISCOELASTIC_PLASTIC

start_time = 0.0
end_time = 12.0
dt_initial = 0.0005
dt_min = 1.0e-7
dt_max = 0.005
adaptive_timestepping = true
cfl_number = 0.4

output_dir = output/scec_tpv101
output_format = HDF5
output_frequency = 200

[GRID]
nx = 300
ny = 300
nz = 150
Lx = 60000.0
Ly = 60000.0
Lz = 30000.0
dx = 200.0
dy = 200.0
dz = 200.0

[ROCK]
# Elastic properties
density = 2670.0
p_wave_velocity = 6000.0
s_wave_velocity = 3464.0
youngs_modulus = 32.04e9
poissons_ratio = 0.25
shear_modulus = 32.04e9

# Viscoelastic attenuation
enable_attenuation = true
q_kappa = 200.0
q_mu = 100.0
num_relaxation_mechanisms = 3
frequency_range_min = 0.1
frequency_range_max = 10.0

# Off-fault plasticity
enable_plasticity = true
plasticity_model = DRUCKER_PRAGER
plastic_cohesion = 0.5e6
friction_angle = 30.0
bulk_friction = 0.6
plastic_viscosity = 0.03

[FAULT1]
name = main_fault
type = STRIKE_SLIP

x = 30000.0
y = 30000.0
z = -7500.0
strike = 0.0
dip = 90.0
rake = 0.0
length = 30000.0
width = 15000.0

# Slip-weakening friction
friction_law = SLIP_WEAKENING
static_friction = 0.677
dynamic_friction = 0.373
slip_weakening_dc = 0.40
cohesion = 0.0

# Initial stress
initial_normal_stress = 120.0e6
initial_shear_stress = 70.0e6

# Nucleation
nucleation_type = FORCED
nucleation_center_x = 30000.0
nucleation_center_z = -7500.0
nucleation_size = 3000.0
nucleation_shear_stress = 81.6e6

[BC1]
type = FREE_SURFACE
location = ZMAX

[BC2]
type = ABSORBING
location = XMIN
method = PML
pml_thickness = 3000.0

[BC3]
type = ABSORBING
location = XMAX
method = PML
pml_thickness = 3000.0

[BC4]
type = ABSORBING
location = YMIN
method = PML
pml_thickness = 3000.0

[BC5]
type = ABSORBING
location = YMAX
method = PML
pml_thickness = 3000.0

[BC6]
type = ABSORBING
location = ZMIN
method = PML
pml_thickness = 3000.0

# Receivers
[RECEIVER1]
name = flt_center
location = 30000.0, 30000.0, -7500.0
output_fields = slip_rate, slip, traction

[RECEIVER2]
name = oflt_center_5km
location = 30000.0, 35000.0, -7500.0
output_fields = velocity, stress, plastic_strain

[RECEIVER3]
name = surf_center
location = 30000.0, 30000.0, 0.0
output_fields = velocity, displacement

# Plasticity output
[OUTPUT_FIELDS]
plastic_strain = true
plastic_work = true
accumulated_plastic_strain = true

[SOLVER]
method = EXPLICIT
time_integration = ADER_DG
polynomial_order = 4
