# =============================================================================
# SCEC TPV24 Benchmark Configuration
# Japan Benchmark with Rate-State Friction (Homogeneous Stress)
# =============================================================================
#
# Reference: SCEC-Japan Collaborative Benchmark
#            https://strike.scec.org/cvws/tpv24_25docs.html
#
# Domain: 3D elastic half-space
# Fault: Vertical strike-slip fault
# Friction: Rate-and-state with flash heating / strong velocity weakening
# Tests: Extreme velocity weakening, thermal effects
#
# =============================================================================

[SIMULATION]
name = scec_tpv24
description = SCEC TPV24 - Japan Benchmark (Homogeneous)
dimension = 3
physics = ELASTODYNAMICS
solid_model = ELASTIC

# Time control
start_time = 0.0
end_time = 15.0
dt_initial = 0.0002
dt_min = 1.0e-8
dt_max = 0.002
adaptive_timestepping = true
cfl_number = 0.3

# Output
output_dir = output/scec_tpv24
output_format = HDF5
output_frequency = 500

[GRID]
nx = 400
ny = 400
nz = 200
Lx = 80000.0
Ly = 80000.0
Lz = 40000.0
dx = 200.0
dy = 200.0
dz = 200.0

[ROCK]
density = 2700.0
p_wave_velocity = 5770.0
s_wave_velocity = 3333.0
youngs_modulus = 30.0e9
poissons_ratio = 0.25
shear_modulus = 30.0e9

[FAULT1]
name = main_fault
type = STRIKE_SLIP

x = 40000.0
y = 40000.0
z = -10000.0
strike = 0.0
dip = 90.0
rake = 0.0
length = 40000.0
width = 20000.0

# Rate-state friction with strong velocity weakening
friction_law = STRONG_VELOCITY_WEAKENING
static_friction = 0.76
dynamic_friction = 0.10
slip_weakening_dc = 0.50
reference_velocity = 1.0e-6
weakening_velocity = 0.17

# Flash heating parameters
enable_flash_heating = true
flash_heating_fw = 0.10
flash_heating_vw = 0.17
thermal_diffusivity = 1.0e-6

# Initial stress
initial_normal_stress = 112.0e6
initial_shear_stress = 85.0e6

# Nucleation
nucleation_type = TIME_WEAKENING
nucleation_center_x = 40000.0
nucleation_center_z = -10000.0
nucleation_radius = 3000.0
nucleation_time = 1.0

[BC1]
type = FREE_SURFACE
location = ZMAX

[BC2]
type = ABSORBING
location = XMIN
method = PML
pml_thickness = 4000.0

[BC3]
type = ABSORBING
location = XMAX
method = PML
pml_thickness = 4000.0

[BC4]
type = ABSORBING
location = YMIN
method = PML
pml_thickness = 4000.0

[BC5]
type = ABSORBING
location = YMAX
method = PML
pml_thickness = 4000.0

[BC6]
type = ABSORBING
location = ZMIN
method = PML
pml_thickness = 4000.0

# Fault receivers
[RECEIVER1]
name = flt_center
location = 40000.0, 40000.0, -10000.0
output_fields = slip_rate, slip, traction, state_variable

[RECEIVER2]
name = flt_st050
location = 45000.0, 40000.0, -10000.0
output_fields = slip_rate, slip, traction

# Surface receivers
[RECEIVER3]
name = surf_center
location = 40000.0, 40000.0, 0.0
output_fields = velocity, displacement

[SOLVER]
method = EXPLICIT
time_integration = ADER_DG
polynomial_order = 5
